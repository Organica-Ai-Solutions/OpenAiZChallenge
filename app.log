2025-05-29 16:46:08,111 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-29 16:58:25,633 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-29 16:58:25,634 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-29 16:58:49,920 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-29 16:58:49,921 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-29 16:58:49,923 - src.main - INFO - Application startup: Initializing resources...
2025-05-29 16:58:49,988 - src.infrastructure.redis_client - WARNING - Failed to connect to Redis: Error 8 connecting to nis-redis:6379. nodename nor servname provided, or not known.
2025-05-29 16:58:49,988 - src.infrastructure.redis_client - ERROR - CRITICAL: Could not connect to Redis at nis-redis:6379 during initial client creation: Error 8 connecting to nis-redis:6379. nodename nor servname provided, or not known.
2025-05-29 16:58:49,988 - src.main - ERROR - CRITICAL: Failed to initialize Redis: Error 8 connecting to nis-redis:6379. nodename nor servname provided, or not known.
Traceback (most recent call last):
  File "/Users/diegofuego/Desktop/openai-to-z-nis/venv/lib/python3.10/site-packages/redis/connection.py", line 264, in connect
    sock = self.retry.call_with_retry(
  File "/Users/diegofuego/Desktop/openai-to-z-nis/venv/lib/python3.10/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/diegofuego/Desktop/openai-to-z-nis/venv/lib/python3.10/site-packages/redis/connection.py", line 265, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/Users/diegofuego/Desktop/openai-to-z-nis/venv/lib/python3.10/site-packages/redis/connection.py", line 595, in _connect
    for res in socket.getaddrinfo(
  File "/Users/diegofuego/.pyenv/versions/3.10.6/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/diegofuego/Desktop/openai-to-z-nis/src/main.py", line 60, in lifespan
    redis_client_instance = get_redis_client()
  File "/Users/diegofuego/Desktop/openai-to-z-nis/src/infrastructure/redis_client.py", line 163, in get_redis_client
    _redis_client = RedisClient(host=host, port=port, db=db)
  File "/Users/diegofuego/Desktop/openai-to-z-nis/src/infrastructure/redis_client.py", line 36, in __init__
    self.redis.ping()
  File "/Users/diegofuego/Desktop/openai-to-z-nis/venv/lib/python3.10/site-packages/redis/commands/core.py", line 1216, in ping
    return self.execute_command("PING", **kwargs)
  File "/Users/diegofuego/Desktop/openai-to-z-nis/venv/lib/python3.10/site-packages/redis/client.py", line 533, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/Users/diegofuego/Desktop/openai-to-z-nis/venv/lib/python3.10/site-packages/redis/connection.py", line 1086, in get_connection
    connection.connect()
  File "/Users/diegofuego/Desktop/openai-to-z-nis/venv/lib/python3.10/site-packages/redis/connection.py", line 270, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 8 connecting to nis-redis:6379. nodename nor servname provided, or not known.
2025-05-29 16:58:49,992 - src.main - WARNING - StatisticsCollector not initialized as Redis is unavailable.
2025-05-29 16:58:49,992 - src.infrastructure.health_monitoring - INFO - HealthMonitor starting up...
2025-05-29 16:58:49,992 - src.infrastructure.distributed_processing - INFO - Starting Dask client in local mode...
2025-05-29 16:58:49,992 - src.infrastructure.distributed_processing - INFO - Setting up local Dask cluster...
2025-05-29 16:58:51,039 - src.infrastructure.distributed_processing - INFO - LocalCluster initialized: LocalCluster(f2dafdfe, 'tcp://127.0.0.1:63133', workers=8, threads=16, memory=16.00 GiB)
2025-05-29 16:58:51,046 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client type after sync init: <class 'distributed.client.Client'>
2025-05-29 16:58:51,046 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client dir after sync init: ['_Client__loop', '__aenter__', '__aexit__', '__annotations__', '__await__', '__class__', '__del__', '__delattr__', '__dict__', '__dir__', '__doc__', '__enter__', '__eq__', '__exit__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_asynchronous', '_cancel', '_close', '_connecting_to_scheduler', '_dec_ref', '_default_event_handlers', '_deserializers', '_dump_cluster_state', '_ensure_connected', '_event_handlers', '_expand_key', '_gather', '_gather_future', '_gather_keys', '_gather_remote', '_gather_semaphore', '_get_components_from_future', '_get_computation_code', '_get_dataset', '_get_errored_future', '_get_raw_components_from_future', '_get_scheduler_info', '_get_task_stream', '_get_versions', '_graph_to_futures', '_handle_cancelled_keys', '_handle_error', '_handle_event', '_handle_forwarded_log_record', '_handle_key_in_memory', '_handle_lost_data', '_handle_report', '_handle_report_task', '_handle_restart', '_handle_retried_key', '_handle_task_erred', '_heartbeat', '_inc_ref', '_instances', '_loop_runner', '_optimize_insert_futures', '_pending_msg_buffer', '_periodic_callbacks', '_prepare_raw_components', '_profile', '_publish_dataset', '_rebalance', '_reconnect', '_refcount_lock', '_register_scheduler_plugin', '_register_worker_plugin', '_release_key', '_replicate', '_repr_html_', '_restart', '_restart_workers', '_retry', '_run', '_run_on_scheduler', '_scatter', '_scheduler_identity', '_send_to_scheduler', '_send_to_scheduler_safe', '_serializers', '_set_as_default', '_set_config', '_shutdown', '_start', '_start_arg', '_startup_kwargs', '_state_handlers', '_story', '_stream_handlers', '_timeout', '_unregister_worker_plugin', '_update_scheduler_info', '_upload_large_file', '_wait_for_handle_report_task', '_wait_for_workers', 'amm', 'as_current', 'asynchronous', 'benchmark_hardware', 'call_stack', 'cancel', 'close', 'cluster', 'collections_to_dsk', 'compute', 'connection_args', 'current', 'dashboard_link', 'datasets', 'direct_to_workers', 'dump_cluster_state', 'extensions', 'forward_logging', 'futures', 'futures_of', 'gather', 'generation', 'get', 'get_dataset', 'get_events', 'get_executor', 'get_metadata', 'get_scheduler_logs', 'get_task_stream', 'get_versions', 'get_worker_logs', 'has_what', 'id', 'io_loop', 'list_datasets', 'log_event', 'loop', 'map', 'nbytes', 'ncores', 'normalize_collection', 'nthreads', 'persist', 'preloads', 'processing', 'profile', 'publish_dataset', 'rebalance', 'recreate_error_locally', 'recreate_task_locally', 'refcount', 'register_scheduler_plugin', 'register_worker_callbacks', 'register_worker_plugin', 'replicate', 'restart', 'restart_workers', 'retire_workers', 'retry', 'rpc', 'run', 'run_on_scheduler', 'scatter', 'scheduler', 'scheduler_comm', 'scheduler_file', 'scheduler_info', 'security', 'set_metadata', 'shutdown', 'start', 'status', 'story', 'submit', 'subscribe_topic', 'sync', 'unforward_logging', 'unpublish_dataset', 'unregister_worker_plugin', 'unsubscribe_topic', 'upload_file', 'wait_for_workers', 'who_has', 'write_scheduler_file']
2025-05-29 16:58:51,046 - src.infrastructure.distributed_processing - INFO - Dask LocalCluster started and client connected: http://127.0.0.1:63132/status
2025-05-29 16:58:51,046 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager started successfully.
2025-05-29 16:58:51,046 - src.main - INFO - HealthMonitor initialized and Dask started, attached to app_param.state.health_monitor
2025-05-29 17:02:30,414 - src.infrastructure.health_monitoring - ERROR - Redis health check failed: Error 8 connecting to nis-redis:6379. nodename nor servname provided, or not known.
2025-05-29 17:02:30,436 - kafka.conn - WARNING - DNS lookup failed for nis-kafka:9092, exception was [Errno 8] nodename nor servname provided, or not known. Is your advertised.listeners (called advertised.host.name before Kafka 9) correct and resolvable?
2025-05-29 17:02:30,437 - kafka.conn - ERROR - DNS lookup failed for nis-kafka:9092 (AddressFamily.AF_UNSPEC)
2025-05-29 17:02:30,437 - kafka.conn - INFO - Probing node bootstrap-0 broker version
2025-05-29 17:02:30,439 - kafka.conn - WARNING - DNS lookup failed for nis-kafka:9092, exception was [Errno 8] nodename nor servname provided, or not known. Is your advertised.listeners (called advertised.host.name before Kafka 9) correct and resolvable?
2025-05-29 17:02:30,439 - kafka.conn - ERROR - DNS lookup failed for nis-kafka:9092 (AddressFamily.AF_UNSPEC)
2025-05-29 17:02:30,439 - src.infrastructure.health_monitoring - ERROR - Kafka health check failed: NoBrokersAvailable
2025-05-29 17:02:30,445 - src.infrastructure.health_monitoring - ERROR - Health check failed: 503: Service Unavailable: System is in a degraded state
Traceback (most recent call last):
  File "/Users/diegofuego/Desktop/openai-to-z-nis/src/infrastructure/health_monitoring.py", line 198, in health_check
    raise HTTPException(
fastapi.exceptions.HTTPException: 503: Service Unavailable: System is in a degraded state
2025-05-29 17:07:15,360 - src.main - INFO - Application shutdown: Cleaning up resources...
2025-05-29 17:07:15,361 - src.infrastructure.health_monitoring - INFO - HealthMonitor shutting down...
2025-05-29 17:07:15,361 - src.infrastructure.distributed_processing - INFO - Shutting down Dask client and cluster...
2025-05-29 17:07:15,363 - src.infrastructure.distributed_processing - ERROR - Error closing Dask client: object NoneType can't be used in 'await' expression
2025-05-29 17:07:15,663 - src.infrastructure.distributed_processing - INFO - Dask cluster closed.
2025-05-29 17:07:15,663 - src.infrastructure.distributed_processing - INFO - Dask shutdown complete.
2025-05-29 17:07:15,663 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager shut down successfully.
2025-05-29 17:07:15,663 - src.main - INFO - Application shutdown complete.
2025-05-29 21:12:49,601 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-29 21:12:49,601 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-29 21:12:49,608 - src.main - INFO - Application startup: Initializing resources...
2025-05-29 21:12:49,619 - src.infrastructure.redis_client - INFO - Connected to Redis at nis-redis:6379
2025-05-29 21:12:49,619 - src.main - INFO - Redis client initialized and attached to app_param.state.redis
2025-05-29 21:12:49,633 - src.infrastructure.kafka_client - INFO - Kafka producer initialized for nis-kafka:9092
2025-05-29 21:12:49,636 - src.main - INFO - StatisticsCollector initialized and attached to app_param.state.stats_collector
2025-05-29 21:12:49,636 - src.infrastructure.health_monitoring - INFO - HealthMonitor starting up...
2025-05-29 21:12:49,636 - src.infrastructure.distributed_processing - INFO - Starting Dask client in local mode...
2025-05-29 21:12:49,637 - src.infrastructure.distributed_processing - INFO - Setting up local Dask cluster...
2025-05-29 21:12:50,872 - src.infrastructure.distributed_processing - INFO - LocalCluster initialized: LocalCluster(5b37e3b5, 'tcp://127.0.0.1:40863', workers=8, threads=16, memory=7.66 GiB)
2025-05-29 21:12:50,883 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client type after sync init: <class 'distributed.client.Client'>
2025-05-29 21:12:50,884 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client dir after sync init: ['_Client__loop', '__aenter__', '__aexit__', '__annotations__', '__await__', '__class__', '__del__', '__delattr__', '__dict__', '__dir__', '__doc__', '__enter__', '__eq__', '__exit__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_asynchronous', '_cancel', '_close', '_connecting_to_scheduler', '_dec_ref', '_default_event_handlers', '_deserializers', '_dump_cluster_state', '_ensure_connected', '_event_handlers', '_expand_key', '_gather', '_gather_future', '_gather_keys', '_gather_remote', '_gather_semaphore', '_get_components_from_future', '_get_computation_code', '_get_dataset', '_get_errored_future', '_get_raw_components_from_future', '_get_scheduler_info', '_get_task_stream', '_get_versions', '_graph_to_futures', '_handle_cancelled_keys', '_handle_error', '_handle_event', '_handle_forwarded_log_record', '_handle_key_in_memory', '_handle_lost_data', '_handle_report', '_handle_report_task', '_handle_restart', '_handle_retried_key', '_handle_task_erred', '_heartbeat', '_inc_ref', '_instances', '_loop_runner', '_optimize_insert_futures', '_pending_msg_buffer', '_periodic_callbacks', '_prepare_raw_components', '_profile', '_publish_dataset', '_rebalance', '_reconnect', '_refcount_lock', '_register_scheduler_plugin', '_register_worker_plugin', '_release_key', '_replicate', '_repr_html_', '_restart', '_restart_workers', '_retry', '_run', '_run_on_scheduler', '_scatter', '_scheduler_identity', '_send_to_scheduler', '_send_to_scheduler_safe', '_serializers', '_set_as_default', '_set_config', '_shutdown', '_start', '_start_arg', '_startup_kwargs', '_state_handlers', '_story', '_stream_handlers', '_timeout', '_unregister_worker_plugin', '_update_scheduler_info', '_upload_large_file', '_wait_for_handle_report_task', '_wait_for_workers', 'amm', 'as_current', 'asynchronous', 'benchmark_hardware', 'call_stack', 'cancel', 'close', 'cluster', 'collections_to_dsk', 'compute', 'connection_args', 'current', 'dashboard_link', 'datasets', 'direct_to_workers', 'dump_cluster_state', 'extensions', 'forward_logging', 'futures', 'futures_of', 'gather', 'generation', 'get', 'get_dataset', 'get_events', 'get_executor', 'get_metadata', 'get_scheduler_logs', 'get_task_stream', 'get_versions', 'get_worker_logs', 'has_what', 'id', 'io_loop', 'list_datasets', 'log_event', 'loop', 'map', 'nbytes', 'ncores', 'normalize_collection', 'nthreads', 'persist', 'preloads', 'processing', 'profile', 'publish_dataset', 'rebalance', 'recreate_error_locally', 'recreate_task_locally', 'refcount', 'register_scheduler_plugin', 'register_worker_callbacks', 'register_worker_plugin', 'replicate', 'restart', 'restart_workers', 'retire_workers', 'retry', 'rpc', 'run', 'run_on_scheduler', 'scatter', 'scheduler', 'scheduler_comm', 'scheduler_file', 'scheduler_info', 'security', 'set_metadata', 'shutdown', 'start', 'status', 'story', 'submit', 'subscribe_topic', 'sync', 'unforward_logging', 'unpublish_dataset', 'unregister_worker_plugin', 'unsubscribe_topic', 'upload_file', 'wait_for_workers', 'who_has', 'write_scheduler_file']
2025-05-29 21:12:50,885 - src.infrastructure.distributed_processing - INFO - Dask LocalCluster started and client connected: http://127.0.0.1:39487/status
2025-05-29 21:12:50,885 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager started successfully.
2025-05-29 21:12:50,885 - src.main - INFO - HealthMonitor initialized and Dask started, attached to app_param.state.health_monitor
2025-05-29 21:12:50,887 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.analysis.events
2025-05-29 21:12:50,887 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.batch.events
2025-05-29 21:12:55,888 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.batch.events starting poll loop after delay.
2025-05-29 21:12:55,892 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.analysis.events starting poll loop after delay.
2025-05-29 21:19:35,588 - kafka.conn - WARNING - DNS lookup failed for nis-kafka:9092, exception was [Errno -2] Name or service not known. Is your advertised.listeners (called advertised.host.name before Kafka 9) correct and resolvable?
2025-05-29 21:19:35,591 - kafka.conn - ERROR - DNS lookup failed for nis-kafka:9092 (AddressFamily.AF_UNSPEC)
2025-05-29 21:19:35,591 - kafka.conn - INFO - Probing node bootstrap-0 broker version
2025-05-29 21:19:35,596 - kafka.conn - WARNING - DNS lookup failed for nis-kafka:9092, exception was [Errno -2] Name or service not known. Is your advertised.listeners (called advertised.host.name before Kafka 9) correct and resolvable?
2025-05-29 21:19:35,596 - kafka.conn - ERROR - DNS lookup failed for nis-kafka:9092 (AddressFamily.AF_UNSPEC)
2025-05-29 21:19:35,597 - src.infrastructure.health_monitoring - ERROR - Kafka health check failed: NoBrokersAvailable
2025-05-29 21:19:35,602 - src.infrastructure.health_monitoring - ERROR - Health check failed: 503: Service Unavailable: System is in a degraded state
Traceback (most recent call last):
  File "/app/src/infrastructure/health_monitoring.py", line 198, in health_check
    raise HTTPException(
fastapi.exceptions.HTTPException: 503: Service Unavailable: System is in a degraded state
2025-05-29 21:38:03,049 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-29 21:38:03,050 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-29 21:38:03,053 - src.main - INFO - Application startup: Initializing resources...
2025-05-29 21:38:03,060 - src.infrastructure.redis_client - INFO - Connected to Redis at nis-redis:6379
2025-05-29 21:38:03,061 - src.main - INFO - Redis client initialized and attached to app_param.state.redis
2025-05-29 21:38:03,070 - src.infrastructure.kafka_client - INFO - Kafka producer initialized for nis-kafka:9092
2025-05-29 21:38:03,071 - src.main - INFO - StatisticsCollector initialized and attached to app_param.state.stats_collector
2025-05-29 21:38:03,071 - src.infrastructure.health_monitoring - INFO - HealthMonitor starting up...
2025-05-29 21:38:03,072 - src.infrastructure.distributed_processing - INFO - Starting Dask client in local mode...
2025-05-29 21:38:03,072 - src.infrastructure.distributed_processing - INFO - Setting up local Dask cluster...
2025-05-29 21:38:04,726 - src.infrastructure.distributed_processing - INFO - LocalCluster initialized: LocalCluster(d28a393d, 'tcp://127.0.0.1:46339', workers=8, threads=16, memory=7.66 GiB)
2025-05-29 21:38:04,737 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client type after sync init: <class 'distributed.client.Client'>
2025-05-29 21:38:04,738 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client dir after sync init: ['_Client__loop', '__aenter__', '__aexit__', '__annotations__', '__await__', '__class__', '__del__', '__delattr__', '__dict__', '__dir__', '__doc__', '__enter__', '__eq__', '__exit__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_asynchronous', '_cancel', '_close', '_connecting_to_scheduler', '_dec_ref', '_default_event_handlers', '_deserializers', '_dump_cluster_state', '_ensure_connected', '_event_handlers', '_expand_key', '_gather', '_gather_future', '_gather_keys', '_gather_remote', '_gather_semaphore', '_get_components_from_future', '_get_computation_code', '_get_dataset', '_get_errored_future', '_get_raw_components_from_future', '_get_scheduler_info', '_get_task_stream', '_get_versions', '_graph_to_futures', '_handle_cancelled_keys', '_handle_error', '_handle_event', '_handle_forwarded_log_record', '_handle_key_in_memory', '_handle_lost_data', '_handle_report', '_handle_report_task', '_handle_restart', '_handle_retried_key', '_handle_task_erred', '_heartbeat', '_inc_ref', '_instances', '_loop_runner', '_optimize_insert_futures', '_pending_msg_buffer', '_periodic_callbacks', '_prepare_raw_components', '_profile', '_publish_dataset', '_rebalance', '_reconnect', '_refcount_lock', '_register_scheduler_plugin', '_register_worker_plugin', '_release_key', '_replicate', '_repr_html_', '_restart', '_restart_workers', '_retry', '_run', '_run_on_scheduler', '_scatter', '_scheduler_identity', '_send_to_scheduler', '_send_to_scheduler_safe', '_serializers', '_set_as_default', '_set_config', '_shutdown', '_start', '_start_arg', '_startup_kwargs', '_state_handlers', '_story', '_stream_handlers', '_timeout', '_unregister_worker_plugin', '_update_scheduler_info', '_upload_large_file', '_wait_for_handle_report_task', '_wait_for_workers', 'amm', 'as_current', 'asynchronous', 'benchmark_hardware', 'call_stack', 'cancel', 'close', 'cluster', 'collections_to_dsk', 'compute', 'connection_args', 'current', 'dashboard_link', 'datasets', 'direct_to_workers', 'dump_cluster_state', 'extensions', 'forward_logging', 'futures', 'futures_of', 'gather', 'generation', 'get', 'get_dataset', 'get_events', 'get_executor', 'get_metadata', 'get_scheduler_logs', 'get_task_stream', 'get_versions', 'get_worker_logs', 'has_what', 'id', 'io_loop', 'list_datasets', 'log_event', 'loop', 'map', 'nbytes', 'ncores', 'normalize_collection', 'nthreads', 'persist', 'preloads', 'processing', 'profile', 'publish_dataset', 'rebalance', 'recreate_error_locally', 'recreate_task_locally', 'refcount', 'register_scheduler_plugin', 'register_worker_callbacks', 'register_worker_plugin', 'replicate', 'restart', 'restart_workers', 'retire_workers', 'retry', 'rpc', 'run', 'run_on_scheduler', 'scatter', 'scheduler', 'scheduler_comm', 'scheduler_file', 'scheduler_info', 'security', 'set_metadata', 'shutdown', 'start', 'status', 'story', 'submit', 'subscribe_topic', 'sync', 'unforward_logging', 'unpublish_dataset', 'unregister_worker_plugin', 'unsubscribe_topic', 'upload_file', 'wait_for_workers', 'who_has', 'write_scheduler_file']
2025-05-29 21:38:04,738 - src.infrastructure.distributed_processing - INFO - Dask LocalCluster started and client connected: http://127.0.0.1:41271/status
2025-05-29 21:38:04,738 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager started successfully.
2025-05-29 21:38:04,738 - src.main - INFO - HealthMonitor initialized and Dask started, attached to app_param.state.health_monitor
2025-05-29 21:38:04,740 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.analysis.events
2025-05-29 21:38:04,740 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.batch.events
2025-05-29 21:38:09,745 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.batch.events starting poll loop after delay.
2025-05-29 21:38:09,745 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.analysis.events starting poll loop after delay.
2025-05-29 21:38:10,757 - src.infrastructure.kafka_client - ERROR - Consumer error: KafkaError{code=UNKNOWN_TOPIC_OR_PART,val=3,str="Subscribed topic not available: nis.analysis.events: Broker: Unknown topic or partition"}
2025-05-29 21:38:10,757 - src.infrastructure.kafka_client - ERROR - Consumer error: KafkaError{code=UNKNOWN_TOPIC_OR_PART,val=3,str="Subscribed topic not available: nis.batch.events: Broker: Unknown topic or partition"}
2025-05-29 21:38:10,758 - src.infrastructure.kafka_client - INFO - Consumer closed for topic nis.analysis.events
2025-05-29 21:38:10,759 - src.infrastructure.kafka_client - INFO - Consumer closed for topic nis.batch.events
2025-05-29 21:53:40,663 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-29 21:53:40,665 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-29 21:53:40,668 - src.main - INFO - Application startup: Initializing resources...
2025-05-29 21:53:40,674 - src.infrastructure.redis_client - INFO - Connected to Redis at nis-redis:6379
2025-05-29 21:53:40,675 - src.main - INFO - Redis client initialized and attached to app_param.state.redis
2025-05-29 21:53:40,690 - src.infrastructure.kafka_client - INFO - Kafka producer initialized for nis-kafka:9092
2025-05-29 21:53:40,691 - src.main - INFO - StatisticsCollector initialized and attached to app_param.state.stats_collector
2025-05-29 21:53:40,692 - src.infrastructure.health_monitoring - INFO - HealthMonitor starting up...
2025-05-29 21:53:40,692 - src.infrastructure.distributed_processing - INFO - Starting Dask client in local mode...
2025-05-29 21:53:40,692 - src.infrastructure.distributed_processing - INFO - Setting up local Dask cluster...
2025-05-29 21:53:42,604 - src.infrastructure.distributed_processing - INFO - LocalCluster initialized: LocalCluster(1e6f4470, 'tcp://127.0.0.1:36981', workers=8, threads=16, memory=7.66 GiB)
2025-05-29 21:53:42,628 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client type after sync init: <class 'distributed.client.Client'>
2025-05-29 21:53:42,628 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client dir after sync init: ['_Client__loop', '__aenter__', '__aexit__', '__annotations__', '__await__', '__class__', '__del__', '__delattr__', '__dict__', '__dir__', '__doc__', '__enter__', '__eq__', '__exit__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_asynchronous', '_cancel', '_close', '_connecting_to_scheduler', '_dec_ref', '_default_event_handlers', '_deserializers', '_dump_cluster_state', '_ensure_connected', '_event_handlers', '_expand_key', '_gather', '_gather_future', '_gather_keys', '_gather_remote', '_gather_semaphore', '_get_components_from_future', '_get_computation_code', '_get_dataset', '_get_errored_future', '_get_raw_components_from_future', '_get_scheduler_info', '_get_task_stream', '_get_versions', '_graph_to_futures', '_handle_cancelled_keys', '_handle_error', '_handle_event', '_handle_forwarded_log_record', '_handle_key_in_memory', '_handle_lost_data', '_handle_report', '_handle_report_task', '_handle_restart', '_handle_retried_key', '_handle_task_erred', '_heartbeat', '_inc_ref', '_instances', '_loop_runner', '_optimize_insert_futures', '_pending_msg_buffer', '_periodic_callbacks', '_prepare_raw_components', '_profile', '_publish_dataset', '_rebalance', '_reconnect', '_refcount_lock', '_register_scheduler_plugin', '_register_worker_plugin', '_release_key', '_replicate', '_repr_html_', '_restart', '_restart_workers', '_retry', '_run', '_run_on_scheduler', '_scatter', '_scheduler_identity', '_send_to_scheduler', '_send_to_scheduler_safe', '_serializers', '_set_as_default', '_set_config', '_shutdown', '_start', '_start_arg', '_startup_kwargs', '_state_handlers', '_story', '_stream_handlers', '_timeout', '_unregister_worker_plugin', '_update_scheduler_info', '_upload_large_file', '_wait_for_handle_report_task', '_wait_for_workers', 'amm', 'as_current', 'asynchronous', 'benchmark_hardware', 'call_stack', 'cancel', 'close', 'cluster', 'collections_to_dsk', 'compute', 'connection_args', 'current', 'dashboard_link', 'datasets', 'direct_to_workers', 'dump_cluster_state', 'extensions', 'forward_logging', 'futures', 'futures_of', 'gather', 'generation', 'get', 'get_dataset', 'get_events', 'get_executor', 'get_metadata', 'get_scheduler_logs', 'get_task_stream', 'get_versions', 'get_worker_logs', 'has_what', 'id', 'io_loop', 'list_datasets', 'log_event', 'loop', 'map', 'nbytes', 'ncores', 'normalize_collection', 'nthreads', 'persist', 'preloads', 'processing', 'profile', 'publish_dataset', 'rebalance', 'recreate_error_locally', 'recreate_task_locally', 'refcount', 'register_scheduler_plugin', 'register_worker_callbacks', 'register_worker_plugin', 'replicate', 'restart', 'restart_workers', 'retire_workers', 'retry', 'rpc', 'run', 'run_on_scheduler', 'scatter', 'scheduler', 'scheduler_comm', 'scheduler_file', 'scheduler_info', 'security', 'set_metadata', 'shutdown', 'start', 'status', 'story', 'submit', 'subscribe_topic', 'sync', 'unforward_logging', 'unpublish_dataset', 'unregister_worker_plugin', 'unsubscribe_topic', 'upload_file', 'wait_for_workers', 'who_has', 'write_scheduler_file']
2025-05-29 21:53:42,628 - src.infrastructure.distributed_processing - INFO - Dask LocalCluster started and client connected: http://127.0.0.1:41157/status
2025-05-29 21:53:42,629 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager started successfully.
2025-05-29 21:53:42,629 - src.main - INFO - HealthMonitor initialized and Dask started, attached to app_param.state.health_monitor
2025-05-29 21:53:42,630 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.analysis.events
2025-05-29 21:53:42,631 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.batch.events
2025-05-29 21:53:47,633 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.analysis.events starting poll loop after delay.
2025-05-29 21:53:47,636 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.batch.events starting poll loop after delay.
2025-05-29 21:53:48,647 - src.infrastructure.kafka_client - ERROR - Consumer error: KafkaError{code=UNKNOWN_TOPIC_OR_PART,val=3,str="Subscribed topic not available: nis.batch.events: Broker: Unknown topic or partition"}
2025-05-29 21:53:48,648 - src.infrastructure.kafka_client - ERROR - Consumer error: KafkaError{code=UNKNOWN_TOPIC_OR_PART,val=3,str="Subscribed topic not available: nis.analysis.events: Broker: Unknown topic or partition"}
2025-05-29 21:53:48,649 - src.infrastructure.kafka_client - INFO - Consumer closed for topic nis.batch.events
2025-05-29 21:53:48,650 - src.infrastructure.kafka_client - INFO - Consumer closed for topic nis.analysis.events
2025-05-29 22:01:06,911 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-29 22:01:06,913 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-29 22:01:06,916 - src.main - INFO - Application startup: Initializing resources...
2025-05-29 22:01:06,927 - src.infrastructure.redis_client - INFO - Connected to Redis at nis-redis:6379
2025-05-29 22:01:06,927 - src.main - INFO - Redis client initialized and attached to app_param.state.redis
2025-05-29 22:01:06,931 - src.infrastructure.kafka_client - INFO - Kafka producer initialized for nis-kafka:9092
2025-05-29 22:01:06,931 - src.main - INFO - StatisticsCollector initialized and attached to app_param.state.stats_collector
2025-05-29 22:01:06,931 - src.infrastructure.health_monitoring - INFO - HealthMonitor starting up...
2025-05-29 22:01:06,931 - src.infrastructure.distributed_processing - INFO - Starting Dask client in local mode...
2025-05-29 22:01:06,931 - src.infrastructure.distributed_processing - INFO - Setting up local Dask cluster...
2025-05-29 22:01:08,444 - src.infrastructure.distributed_processing - INFO - LocalCluster initialized: LocalCluster(3e549516, 'tcp://127.0.0.1:35279', workers=8, threads=16, memory=7.66 GiB)
2025-05-29 22:01:08,451 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client type after sync init: <class 'distributed.client.Client'>
2025-05-29 22:01:08,451 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client dir after sync init: ['_Client__loop', '__aenter__', '__aexit__', '__annotations__', '__await__', '__class__', '__del__', '__delattr__', '__dict__', '__dir__', '__doc__', '__enter__', '__eq__', '__exit__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_asynchronous', '_cancel', '_close', '_connecting_to_scheduler', '_dec_ref', '_default_event_handlers', '_deserializers', '_dump_cluster_state', '_ensure_connected', '_event_handlers', '_expand_key', '_gather', '_gather_future', '_gather_keys', '_gather_remote', '_gather_semaphore', '_get_components_from_future', '_get_computation_code', '_get_dataset', '_get_errored_future', '_get_raw_components_from_future', '_get_scheduler_info', '_get_task_stream', '_get_versions', '_graph_to_futures', '_handle_cancelled_keys', '_handle_error', '_handle_event', '_handle_forwarded_log_record', '_handle_key_in_memory', '_handle_lost_data', '_handle_report', '_handle_report_task', '_handle_restart', '_handle_retried_key', '_handle_task_erred', '_heartbeat', '_inc_ref', '_instances', '_loop_runner', '_optimize_insert_futures', '_pending_msg_buffer', '_periodic_callbacks', '_prepare_raw_components', '_profile', '_publish_dataset', '_rebalance', '_reconnect', '_refcount_lock', '_register_scheduler_plugin', '_register_worker_plugin', '_release_key', '_replicate', '_repr_html_', '_restart', '_restart_workers', '_retry', '_run', '_run_on_scheduler', '_scatter', '_scheduler_identity', '_send_to_scheduler', '_send_to_scheduler_safe', '_serializers', '_set_as_default', '_set_config', '_shutdown', '_start', '_start_arg', '_startup_kwargs', '_state_handlers', '_story', '_stream_handlers', '_timeout', '_unregister_worker_plugin', '_update_scheduler_info', '_upload_large_file', '_wait_for_handle_report_task', '_wait_for_workers', 'amm', 'as_current', 'asynchronous', 'benchmark_hardware', 'call_stack', 'cancel', 'close', 'cluster', 'collections_to_dsk', 'compute', 'connection_args', 'current', 'dashboard_link', 'datasets', 'direct_to_workers', 'dump_cluster_state', 'extensions', 'forward_logging', 'futures', 'futures_of', 'gather', 'generation', 'get', 'get_dataset', 'get_events', 'get_executor', 'get_metadata', 'get_scheduler_logs', 'get_task_stream', 'get_versions', 'get_worker_logs', 'has_what', 'id', 'io_loop', 'list_datasets', 'log_event', 'loop', 'map', 'nbytes', 'ncores', 'normalize_collection', 'nthreads', 'persist', 'preloads', 'processing', 'profile', 'publish_dataset', 'rebalance', 'recreate_error_locally', 'recreate_task_locally', 'refcount', 'register_scheduler_plugin', 'register_worker_callbacks', 'register_worker_plugin', 'replicate', 'restart', 'restart_workers', 'retire_workers', 'retry', 'rpc', 'run', 'run_on_scheduler', 'scatter', 'scheduler', 'scheduler_comm', 'scheduler_file', 'scheduler_info', 'security', 'set_metadata', 'shutdown', 'start', 'status', 'story', 'submit', 'subscribe_topic', 'sync', 'unforward_logging', 'unpublish_dataset', 'unregister_worker_plugin', 'unsubscribe_topic', 'upload_file', 'wait_for_workers', 'who_has', 'write_scheduler_file']
2025-05-29 22:01:08,452 - src.infrastructure.distributed_processing - INFO - Dask LocalCluster started and client connected: http://127.0.0.1:43211/status
2025-05-29 22:01:08,452 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager started successfully.
2025-05-29 22:01:08,452 - src.main - INFO - HealthMonitor initialized and Dask started, attached to app_param.state.health_monitor
2025-05-29 22:01:08,454 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.analysis.events
2025-05-29 22:01:08,454 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.batch.events
2025-05-29 22:01:13,455 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.analysis.events starting poll loop after delay.
2025-05-29 22:01:13,463 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.batch.events starting poll loop after delay.
2025-05-29 22:01:20,439 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=nis-kafka:9092 <connecting> [IPv4 ('172.18.0.4', 9092)]>: connecting to nis-kafka:9092 [('172.18.0.4', 9092) IPv4]
2025-05-29 22:01:20,442 - kafka.conn - INFO - Probing node bootstrap-0 broker version
2025-05-29 22:01:20,443 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=nis-kafka:9092 <connecting> [IPv4 ('172.18.0.4', 9092)]>: Connection complete.
2025-05-29 22:01:20,559 - kafka.conn - INFO - Broker version identified as 2.5.0
2025-05-29 22:01:20,560 - kafka.conn - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-05-29 22:01:20,562 - kafka.coordinator.consumer - WARNING - group_id is None: disabling auto-commit.
2025-05-30 02:58:48,107 - src.main - INFO - Application shutdown: Cleaning up resources...
2025-05-30 02:58:48,112 - src.infrastructure.health_monitoring - INFO - HealthMonitor shutting down...
2025-05-30 02:58:48,113 - src.infrastructure.distributed_processing - INFO - Shutting down Dask client and cluster...
2025-05-30 02:58:48,136 - src.infrastructure.distributed_processing - ERROR - Error closing Dask client: object NoneType can't be used in 'await' expression
2025-05-30 02:58:49,035 - src.infrastructure.distributed_processing - INFO - Dask cluster closed.
2025-05-30 02:58:49,036 - src.infrastructure.distributed_processing - INFO - Dask shutdown complete.
2025-05-30 02:58:49,036 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager shut down successfully.
2025-05-30 02:58:49,041 - src.infrastructure.redis_client - INFO - Redis connection closed
2025-05-30 02:58:49,042 - src.main - INFO - Redis client connection closed.
2025-05-30 02:58:49,042 - src.main - INFO - Application shutdown complete.
2025-05-30 02:59:02,577 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 02:59:02,578 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 02:59:03,210 - src.meta.coordinator - INFO - MetaProtocolCoordinator initialized
2025-05-30 02:59:04,889 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 02:59:04,899 - src.agents.vision_agent - INFO - Vision Agent initialized with GPTIntegration (gpt-4-turbo)
2025-05-30 02:59:04,900 - src.agents.reasoning_agent - INFO - Loaded reasoning prompt from src/prompts/reasoning_prompt.txt
2025-05-30 02:59:05,899 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 02:59:05,901 - src.agents.reasoning_agent - INFO - Initialized GPT integration with model: gpt-4-turbo
2025-05-30 02:59:05,901 - src.agents.reasoning_agent - INFO - Reasoning Agent initialized
2025-05-30 02:59:06,841 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 02:59:06,842 - src.agents.memory_agent - INFO - Initialized GPT integration for Memory Agent with model: gpt-4o
2025-05-30 02:59:06,846 - src.infrastructure.redis_client - INFO - Connected to Redis at nis-redis:6379
2025-05-30 02:59:06,847 - src.agents.memory_agent - INFO - Initialized Redis for Memory Agent caching
2025-05-30 02:59:06,853 - src.infrastructure.kafka_client - INFO - Kafka producer initialized for nis-kafka:9092
2025-05-30 02:59:06,853 - src.agents.memory_agent - INFO - Initialized Kafka for Memory Agent events
2025-05-30 02:59:06,853 - src.agents.memory_agent - INFO - Memory Agent initialized with storage at outputs/memory
2025-05-30 02:59:06,854 - src.agents.action_agent - INFO - Action Agent initialized with output dir at outputs/findings
2025-05-30 02:59:22,102 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 02:59:22,103 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 02:59:22,569 - src.meta.coordinator - INFO - MetaProtocolCoordinator initialized
2025-05-30 02:59:23,523 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 02:59:23,526 - src.agents.vision_agent - INFO - Vision Agent initialized with GPTIntegration (gpt-4-turbo)
2025-05-30 02:59:23,526 - src.agents.reasoning_agent - INFO - Loaded reasoning prompt from src/prompts/reasoning_prompt.txt
2025-05-30 02:59:24,854 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 02:59:24,855 - src.agents.reasoning_agent - INFO - Initialized GPT integration with model: gpt-4-turbo
2025-05-30 02:59:24,856 - src.agents.reasoning_agent - INFO - Reasoning Agent initialized
2025-05-30 02:59:25,773 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 02:59:25,775 - src.agents.memory_agent - INFO - Initialized GPT integration for Memory Agent with model: gpt-4o
2025-05-30 02:59:25,778 - src.infrastructure.redis_client - INFO - Connected to Redis at nis-redis:6379
2025-05-30 02:59:25,779 - src.agents.memory_agent - INFO - Initialized Redis for Memory Agent caching
2025-05-30 02:59:25,785 - src.infrastructure.kafka_client - INFO - Kafka producer initialized for nis-kafka:9092
2025-05-30 02:59:25,785 - src.agents.memory_agent - INFO - Initialized Kafka for Memory Agent events
2025-05-30 02:59:25,785 - src.agents.memory_agent - INFO - Memory Agent initialized with storage at outputs/memory
2025-05-30 02:59:25,786 - src.agents.action_agent - INFO - Action Agent initialized with output dir at outputs/findings
2025-05-30 03:00:15,654 - src.meta.coordinator - INFO - Registered protocol adapter: mcp
2025-05-30 03:00:15,657 - src.meta.coordinator - INFO - Registered protocol adapter: acp
2025-05-30 03:00:15,657 - src.meta.coordinator - INFO - Registered protocol adapter: a2a
2025-05-30 03:00:15,657 - src.meta.coordinator - INFO - Registered agent: vision_agent
2025-05-30 03:00:15,657 - src.meta.coordinator - INFO - Registered agent: reasoning_agent
2025-05-30 03:00:15,658 - src.meta.coordinator - INFO - Registered agent: memory_agent
2025-05-30 03:00:15,658 - src.meta.coordinator - INFO - Registered agent: action_agent
2025-05-30 03:00:15,717 - api.agent_integrator - INFO - LangGraph workflow compiled.
2025-05-30 03:00:15,718 - api.agent_integrator - INFO - NIS Protocol agents, coordinator, and graph initialized successfully
2025-05-30 03:00:16,051 - src.main - INFO - Application startup: Initializing resources...
2025-05-30 03:00:16,052 - src.main - INFO - Redis client initialized and attached to app_param.state.redis
2025-05-30 03:00:16,053 - src.main - INFO - StatisticsCollector initialized and attached to app_param.state.stats_collector
2025-05-30 03:00:16,055 - src.infrastructure.health_monitoring - INFO - HealthMonitor starting up...
2025-05-30 03:00:16,057 - src.infrastructure.distributed_processing - INFO - Starting Dask client in local mode...
2025-05-30 03:00:16,057 - src.infrastructure.distributed_processing - INFO - Setting up local Dask cluster...
2025-05-30 03:00:19,939 - src.infrastructure.distributed_processing - INFO - LocalCluster initialized: LocalCluster(eb8d4368, 'tcp://127.0.0.1:38743', workers=8, threads=16, memory=7.66 GiB)
2025-05-30 03:00:19,976 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client type after sync init: <class 'distributed.client.Client'>
2025-05-30 03:00:19,977 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client dir after sync init: ['_Client__loop', '__aenter__', '__aexit__', '__annotations__', '__await__', '__class__', '__del__', '__delattr__', '__dict__', '__dir__', '__doc__', '__enter__', '__eq__', '__exit__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_asynchronous', '_cancel', '_close', '_connecting_to_scheduler', '_dec_ref', '_default_event_handlers', '_deserializers', '_dump_cluster_state', '_ensure_connected', '_event_handlers', '_expand_key', '_gather', '_gather_future', '_gather_keys', '_gather_remote', '_gather_semaphore', '_get_components_from_future', '_get_computation_code', '_get_dataset', '_get_errored_future', '_get_raw_components_from_future', '_get_scheduler_info', '_get_task_stream', '_get_versions', '_graph_to_futures', '_handle_cancelled_keys', '_handle_error', '_handle_event', '_handle_forwarded_log_record', '_handle_key_in_memory', '_handle_lost_data', '_handle_report', '_handle_report_task', '_handle_restart', '_handle_retried_key', '_handle_task_erred', '_heartbeat', '_inc_ref', '_instances', '_loop_runner', '_optimize_insert_futures', '_pending_msg_buffer', '_periodic_callbacks', '_prepare_raw_components', '_profile', '_publish_dataset', '_rebalance', '_reconnect', '_refcount_lock', '_register_scheduler_plugin', '_register_worker_plugin', '_release_key', '_replicate', '_repr_html_', '_restart', '_restart_workers', '_retry', '_run', '_run_on_scheduler', '_scatter', '_scheduler_identity', '_send_to_scheduler', '_send_to_scheduler_safe', '_serializers', '_set_as_default', '_set_config', '_shutdown', '_start', '_start_arg', '_startup_kwargs', '_state_handlers', '_story', '_stream_handlers', '_timeout', '_unregister_worker_plugin', '_update_scheduler_info', '_upload_large_file', '_wait_for_handle_report_task', '_wait_for_workers', 'amm', 'as_current', 'asynchronous', 'benchmark_hardware', 'call_stack', 'cancel', 'close', 'cluster', 'collections_to_dsk', 'compute', 'connection_args', 'current', 'dashboard_link', 'datasets', 'direct_to_workers', 'dump_cluster_state', 'extensions', 'forward_logging', 'futures', 'futures_of', 'gather', 'generation', 'get', 'get_dataset', 'get_events', 'get_executor', 'get_metadata', 'get_scheduler_logs', 'get_task_stream', 'get_versions', 'get_worker_logs', 'has_what', 'id', 'io_loop', 'list_datasets', 'log_event', 'loop', 'map', 'nbytes', 'ncores', 'normalize_collection', 'nthreads', 'persist', 'preloads', 'processing', 'profile', 'publish_dataset', 'rebalance', 'recreate_error_locally', 'recreate_task_locally', 'refcount', 'register_scheduler_plugin', 'register_worker_callbacks', 'register_worker_plugin', 'replicate', 'restart', 'restart_workers', 'retire_workers', 'retry', 'rpc', 'run', 'run_on_scheduler', 'scatter', 'scheduler', 'scheduler_comm', 'scheduler_file', 'scheduler_info', 'security', 'set_metadata', 'shutdown', 'start', 'status', 'story', 'submit', 'subscribe_topic', 'sync', 'unforward_logging', 'unpublish_dataset', 'unregister_worker_plugin', 'unsubscribe_topic', 'upload_file', 'wait_for_workers', 'who_has', 'write_scheduler_file']
2025-05-30 03:00:19,978 - src.infrastructure.distributed_processing - INFO - Dask LocalCluster started and client connected: http://127.0.0.1:37251/status
2025-05-30 03:00:19,978 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager started successfully.
2025-05-30 03:00:19,978 - src.main - INFO - HealthMonitor initialized and Dask started, attached to app_param.state.health_monitor
2025-05-30 03:00:19,981 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.analysis.events
2025-05-30 03:00:19,982 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.batch.events
2025-05-30 03:00:24,983 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.batch.events starting poll loop after delay.
2025-05-30 03:00:24,990 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.analysis.events starting poll loop after delay.
2025-05-30 03:12:19,816 - api.analyze - INFO - Analyzing coordinates 34.0522, -118.2437 with data sources: {'satellite': True, 'lidar': True, 'historicalTexts': True, 'indigenousMaps': True}
2025-05-30 03:12:19,902 - api.agent_integrator - INFO - Executing Vision Analysis Node (Iteration: 0)
2025-05-30 03:12:19,908 - src.agents.vision_agent - ERROR - Error processing satellite data: Satellite tile not found: data/satellite/tile_340_1182.tif.
2025-05-30 03:12:19,926 - src.agents.vision_agent - ERROR - Error processing LIDAR data: LIDAR tile not found: data/lidar/tile_340_1182.tif.
2025-05-30 03:12:19,958 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 0)
2025-05-30 03:12:20,039 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 0)
2025-05-30 03:12:20,044 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:12:20,045 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 0
2025-05-30 03:12:20,046 - src.agents.action_agent - INFO - Strategy: Very low confidence (0.1). Expanding pattern search.
2025-05-30 03:12:20,048 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 0)
2025-05-30 03:12:20,053 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 1)
2025-05-30 03:12:20,058 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:12:20,058 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 1
2025-05-30 03:12:20,059 - src.agents.action_agent - INFO - Strategy: Very low confidence (0.1). Expanding pattern search.
2025-05-30 03:12:20,062 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 1)
2025-05-30 03:12:20,072 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 2)
2025-05-30 03:12:20,074 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:12:20,074 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 2
2025-05-30 03:12:20,074 - src.agents.action_agent - INFO - Strategy: Very low confidence (0.1). Expanding pattern search.
2025-05-30 03:12:20,076 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 2)
2025-05-30 03:12:20,082 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 3)
2025-05-30 03:12:20,085 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:12:20,086 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 3
2025-05-30 03:12:20,086 - src.agents.action_agent - INFO - Strategy: Max iterations reached or high confidence. Finalizing. Confidence: 0.1
2025-05-30 03:12:20,088 - api.agent_integrator - ERROR - Error in NIS Protocol analysis: get_latest_observation must be implemented with real data tracking.
Traceback (most recent call last):
  File "/app/api/agent_integrator.py", line 261, in analyze_coordinates
    final_graph_output = await self.graph.ainvoke(initial_state)
  File "/usr/local/lib/python3.10/site-packages/langgraph/pregel/__init__.py", line 2788, in ainvoke
    async for chunk in self.astream(
  File "/usr/local/lib/python3.10/site-packages/langgraph/pregel/__init__.py", line 2655, in astream
    async for _ in runner.atick(
  File "/usr/local/lib/python3.10/site-packages/langgraph/pregel/runner.py", line 294, in atick
    await arun_with_retry(
  File "/usr/local/lib/python3.10/site-packages/langgraph/pregel/retry.py", line 136, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
  File "/usr/local/lib/python3.10/site-packages/langgraph/utils/runnable.py", line 676, in ainvoke
    input = await step.ainvoke(input, config, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/langgraph/utils/runnable.py", line 440, in ainvoke
    ret = await self.afunc(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/langchain_core/runnables/config.py", line 616, in run_in_executor
    return await asyncio.get_running_loop().run_in_executor(
  File "/usr/local/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/site-packages/langchain_core/runnables/config.py", line 607, in wrapper
    return func(*args, **kwargs)
  File "/app/api/agent_integrator.py", line 577, in consciousness_node
    integrated = self.workspace.integrate_information()
  File "/app/src/agents/consciousness_module.py", line 31, in integrate_information
    visual_data = self.perception.get_latest_observation() if hasattr(self.perception, 'get_latest_observation') else None
  File "/app/src/agents/vision_agent.py", line 426, in get_latest_observation
    raise NotImplementedError("get_latest_observation must be implemented with real data tracking.")
NotImplementedError: get_latest_observation must be implemented with real data tracking.
2025-05-30 03:13:15,754 - src.main - INFO - Application shutdown: Cleaning up resources...
2025-05-30 03:13:15,757 - src.infrastructure.health_monitoring - INFO - HealthMonitor shutting down...
2025-05-30 03:13:15,758 - src.infrastructure.distributed_processing - INFO - Shutting down Dask client and cluster...
2025-05-30 03:13:15,772 - src.infrastructure.distributed_processing - ERROR - Error closing Dask client: object NoneType can't be used in 'await' expression
2025-05-30 03:13:16,595 - src.infrastructure.distributed_processing - INFO - Dask cluster closed.
2025-05-30 03:13:16,596 - src.infrastructure.distributed_processing - INFO - Dask shutdown complete.
2025-05-30 03:13:16,597 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager shut down successfully.
2025-05-30 03:13:16,600 - src.infrastructure.redis_client - INFO - Redis connection closed
2025-05-30 03:13:16,600 - src.main - INFO - Redis client connection closed.
2025-05-30 03:13:16,601 - src.main - INFO - Application shutdown complete.
2025-05-30 03:13:40,999 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:13:41,001 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:13:41,353 - src.meta.coordinator - INFO - MetaProtocolCoordinator initialized
2025-05-30 03:13:42,981 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:13:42,986 - src.agents.vision_agent - INFO - Vision Agent initialized with GPTIntegration (gpt-4-turbo)
2025-05-30 03:13:42,987 - src.agents.reasoning_agent - INFO - Loaded reasoning prompt from src/prompts/reasoning_prompt.txt
2025-05-30 03:13:44,002 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:13:44,003 - src.agents.reasoning_agent - INFO - Initialized GPT integration with model: gpt-4-turbo
2025-05-30 03:13:44,003 - src.agents.reasoning_agent - INFO - Reasoning Agent initialized
2025-05-30 03:13:44,625 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:13:44,627 - src.agents.memory_agent - INFO - Initialized GPT integration for Memory Agent with model: gpt-4o
2025-05-30 03:13:44,632 - src.infrastructure.redis_client - INFO - Connected to Redis at nis-redis:6379
2025-05-30 03:13:44,632 - src.agents.memory_agent - INFO - Initialized Redis for Memory Agent caching
2025-05-30 03:13:44,643 - src.infrastructure.kafka_client - INFO - Kafka producer initialized for nis-kafka:9092
2025-05-30 03:13:44,643 - src.agents.memory_agent - INFO - Initialized Kafka for Memory Agent events
2025-05-30 03:13:44,643 - src.agents.memory_agent - INFO - Memory Agent initialized with storage at outputs/memory
2025-05-30 03:13:44,644 - src.agents.action_agent - INFO - Action Agent initialized with output dir at outputs/findings
2025-05-30 03:13:55,364 - src.meta.coordinator - INFO - Registered protocol adapter: mcp
2025-05-30 03:13:55,367 - src.meta.coordinator - INFO - Registered protocol adapter: acp
2025-05-30 03:13:55,367 - src.meta.coordinator - INFO - Registered protocol adapter: a2a
2025-05-30 03:13:55,368 - src.meta.coordinator - INFO - Registered agent: vision_agent
2025-05-30 03:13:55,368 - src.meta.coordinator - INFO - Registered agent: reasoning_agent
2025-05-30 03:13:55,368 - src.meta.coordinator - INFO - Registered agent: memory_agent
2025-05-30 03:13:55,368 - src.meta.coordinator - INFO - Registered agent: action_agent
2025-05-30 03:13:55,410 - api.agent_integrator - INFO - LangGraph workflow compiled.
2025-05-30 03:13:55,410 - api.agent_integrator - INFO - NIS Protocol agents, coordinator, and graph initialized successfully
2025-05-30 03:13:55,492 - src.main - INFO - Application startup: Initializing resources...
2025-05-30 03:13:55,493 - src.main - INFO - Redis client initialized and attached to app_param.state.redis
2025-05-30 03:13:55,494 - src.main - INFO - StatisticsCollector initialized and attached to app_param.state.stats_collector
2025-05-30 03:13:55,496 - src.infrastructure.health_monitoring - INFO - HealthMonitor starting up...
2025-05-30 03:13:55,497 - src.infrastructure.distributed_processing - INFO - Starting Dask client in local mode...
2025-05-30 03:13:55,498 - src.infrastructure.distributed_processing - INFO - Setting up local Dask cluster...
2025-05-30 03:13:59,437 - src.infrastructure.distributed_processing - INFO - LocalCluster initialized: LocalCluster(9bea5a54, 'tcp://127.0.0.1:40923', workers=4, threads=8, memory=3.83 GiB)
2025-05-30 03:13:59,475 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client type after sync init: <class 'distributed.client.Client'>
2025-05-30 03:13:59,476 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client dir after sync init: ['_Client__loop', '__aenter__', '__aexit__', '__annotations__', '__await__', '__class__', '__del__', '__delattr__', '__dict__', '__dir__', '__doc__', '__enter__', '__eq__', '__exit__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_asynchronous', '_cancel', '_close', '_connecting_to_scheduler', '_dec_ref', '_default_event_handlers', '_deserializers', '_dump_cluster_state', '_ensure_connected', '_event_handlers', '_expand_key', '_gather', '_gather_future', '_gather_keys', '_gather_remote', '_gather_semaphore', '_get_components_from_future', '_get_computation_code', '_get_dataset', '_get_errored_future', '_get_raw_components_from_future', '_get_scheduler_info', '_get_task_stream', '_get_versions', '_graph_to_futures', '_handle_cancelled_keys', '_handle_error', '_handle_event', '_handle_forwarded_log_record', '_handle_key_in_memory', '_handle_lost_data', '_handle_report', '_handle_report_task', '_handle_restart', '_handle_retried_key', '_handle_task_erred', '_heartbeat', '_inc_ref', '_instances', '_loop_runner', '_optimize_insert_futures', '_pending_msg_buffer', '_periodic_callbacks', '_prepare_raw_components', '_profile', '_publish_dataset', '_rebalance', '_reconnect', '_refcount_lock', '_register_scheduler_plugin', '_register_worker_plugin', '_release_key', '_replicate', '_repr_html_', '_restart', '_restart_workers', '_retry', '_run', '_run_on_scheduler', '_scatter', '_scheduler_identity', '_send_to_scheduler', '_send_to_scheduler_safe', '_serializers', '_set_as_default', '_set_config', '_shutdown', '_start', '_start_arg', '_startup_kwargs', '_state_handlers', '_story', '_stream_handlers', '_timeout', '_unregister_worker_plugin', '_update_scheduler_info', '_upload_large_file', '_wait_for_handle_report_task', '_wait_for_workers', 'amm', 'as_current', 'asynchronous', 'benchmark_hardware', 'call_stack', 'cancel', 'close', 'cluster', 'collections_to_dsk', 'compute', 'connection_args', 'current', 'dashboard_link', 'datasets', 'direct_to_workers', 'dump_cluster_state', 'extensions', 'forward_logging', 'futures', 'futures_of', 'gather', 'generation', 'get', 'get_dataset', 'get_events', 'get_executor', 'get_metadata', 'get_scheduler_logs', 'get_task_stream', 'get_versions', 'get_worker_logs', 'has_what', 'id', 'io_loop', 'list_datasets', 'log_event', 'loop', 'map', 'nbytes', 'ncores', 'normalize_collection', 'nthreads', 'persist', 'preloads', 'processing', 'profile', 'publish_dataset', 'rebalance', 'recreate_error_locally', 'recreate_task_locally', 'refcount', 'register_scheduler_plugin', 'register_worker_callbacks', 'register_worker_plugin', 'replicate', 'restart', 'restart_workers', 'retire_workers', 'retry', 'rpc', 'run', 'run_on_scheduler', 'scatter', 'scheduler', 'scheduler_comm', 'scheduler_file', 'scheduler_info', 'security', 'set_metadata', 'shutdown', 'start', 'status', 'story', 'submit', 'subscribe_topic', 'sync', 'unforward_logging', 'unpublish_dataset', 'unregister_worker_plugin', 'unsubscribe_topic', 'upload_file', 'wait_for_workers', 'who_has', 'write_scheduler_file']
2025-05-30 03:13:59,476 - src.infrastructure.distributed_processing - INFO - Dask LocalCluster started and client connected: http://127.0.0.1:42251/status
2025-05-30 03:13:59,477 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager started successfully.
2025-05-30 03:13:59,477 - src.main - INFO - HealthMonitor initialized and Dask started, attached to app_param.state.health_monitor
2025-05-30 03:13:59,487 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.analysis.events
2025-05-30 03:13:59,487 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.batch.events
2025-05-30 03:13:59,562 - api.analyze - INFO - Analyzing coordinates 34.0522, -118.2437 with data sources: {'satellite': True, 'lidar': True, 'historicalTexts': True, 'indigenousMaps': True}
2025-05-30 03:13:59,577 - api.agent_integrator - INFO - Executing Vision Analysis Node (Iteration: 0)
2025-05-30 03:13:59,580 - src.agents.vision_agent - ERROR - Error processing satellite data: Satellite tile not found: data/satellite/tile_340_1182.tif.
2025-05-30 03:13:59,588 - src.agents.vision_agent - ERROR - Error processing LIDAR data: LIDAR tile not found: data/lidar/tile_340_1182.tif.
2025-05-30 03:13:59,594 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 0)
2025-05-30 03:13:59,603 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 0)
2025-05-30 03:13:59,604 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:13:59,604 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 0
2025-05-30 03:13:59,604 - src.agents.action_agent - INFO - Strategy: Very low confidence (0.1). Expanding pattern search.
2025-05-30 03:13:59,605 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 0)
2025-05-30 03:13:59,606 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 1)
2025-05-30 03:13:59,608 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:13:59,608 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 1
2025-05-30 03:13:59,609 - src.agents.action_agent - INFO - Strategy: Very low confidence (0.1). Expanding pattern search.
2025-05-30 03:13:59,611 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 1)
2025-05-30 03:13:59,615 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 2)
2025-05-30 03:13:59,616 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:13:59,617 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 2
2025-05-30 03:13:59,617 - src.agents.action_agent - INFO - Strategy: Very low confidence (0.1). Expanding pattern search.
2025-05-30 03:13:59,617 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 2)
2025-05-30 03:13:59,619 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 3)
2025-05-30 03:13:59,620 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:13:59,620 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 3
2025-05-30 03:13:59,621 - src.agents.action_agent - INFO - Strategy: Max iterations reached or high confidence. Finalizing. Confidence: 0.1
2025-05-30 03:13:59,623 - api.agent_integrator - ERROR - Error in NIS Protocol analysis: recall_context must be implemented with real memory/context retrieval.
Traceback (most recent call last):
  File "/app/api/agent_integrator.py", line 261, in analyze_coordinates
    final_graph_output = await self.graph.ainvoke(initial_state)
  File "/usr/local/lib/python3.10/site-packages/langgraph/pregel/__init__.py", line 2788, in ainvoke
    async for chunk in self.astream(
  File "/usr/local/lib/python3.10/site-packages/langgraph/pregel/__init__.py", line 2655, in astream
    async for _ in runner.atick(
  File "/usr/local/lib/python3.10/site-packages/langgraph/pregel/runner.py", line 294, in atick
    await arun_with_retry(
  File "/usr/local/lib/python3.10/site-packages/langgraph/pregel/retry.py", line 136, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
  File "/usr/local/lib/python3.10/site-packages/langgraph/utils/runnable.py", line 676, in ainvoke
    input = await step.ainvoke(input, config, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/langgraph/utils/runnable.py", line 440, in ainvoke
    ret = await self.afunc(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/langchain_core/runnables/config.py", line 616, in run_in_executor
    return await asyncio.get_running_loop().run_in_executor(
  File "/usr/local/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/site-packages/langchain_core/runnables/config.py", line 607, in wrapper
    return func(*args, **kwargs)
  File "/app/api/agent_integrator.py", line 577, in consciousness_node
    integrated = self.workspace.integrate_information()
  File "/app/src/agents/consciousness_module.py", line 33, in integrate_information
    contextual_memories = self.memory.recall_context(visual_data) if hasattr(self.memory, 'recall_context') else None
  File "/app/src/agents/memory_agent.py", line 851, in recall_context
    raise NotImplementedError("recall_context must be implemented with real memory/context retrieval.")
NotImplementedError: recall_context must be implemented with real memory/context retrieval.
2025-05-30 03:14:04,489 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.analysis.events starting poll loop after delay.
2025-05-30 03:14:04,497 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.batch.events starting poll loop after delay.
2025-05-30 03:14:39,654 - src.main - INFO - Application shutdown: Cleaning up resources...
2025-05-30 03:14:39,656 - src.infrastructure.health_monitoring - INFO - HealthMonitor shutting down...
2025-05-30 03:14:39,656 - src.infrastructure.distributed_processing - INFO - Shutting down Dask client and cluster...
2025-05-30 03:14:39,668 - src.infrastructure.distributed_processing - ERROR - Error closing Dask client: object NoneType can't be used in 'await' expression
2025-05-30 03:14:40,440 - src.infrastructure.distributed_processing - INFO - Dask cluster closed.
2025-05-30 03:14:40,441 - src.infrastructure.distributed_processing - INFO - Dask shutdown complete.
2025-05-30 03:14:40,442 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager shut down successfully.
2025-05-30 03:14:40,450 - src.infrastructure.redis_client - INFO - Redis connection closed
2025-05-30 03:14:40,451 - src.main - INFO - Redis client connection closed.
2025-05-30 03:14:40,451 - src.main - INFO - Application shutdown complete.
2025-05-30 03:15:04,671 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:15:04,679 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:15:05,246 - src.meta.coordinator - INFO - MetaProtocolCoordinator initialized
2025-05-30 03:15:06,395 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:15:06,416 - src.agents.vision_agent - INFO - Vision Agent initialized with GPTIntegration (gpt-4-turbo)
2025-05-30 03:15:06,424 - src.agents.reasoning_agent - INFO - Loaded reasoning prompt from src/prompts/reasoning_prompt.txt
2025-05-30 03:15:07,458 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:15:07,461 - src.agents.reasoning_agent - INFO - Initialized GPT integration with model: gpt-4-turbo
2025-05-30 03:15:07,461 - src.agents.reasoning_agent - INFO - Reasoning Agent initialized
2025-05-30 03:15:08,709 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:15:08,715 - src.agents.memory_agent - INFO - Initialized GPT integration for Memory Agent with model: gpt-4o
2025-05-30 03:15:08,722 - src.infrastructure.redis_client - INFO - Connected to Redis at nis-redis:6379
2025-05-30 03:15:08,722 - src.agents.memory_agent - INFO - Initialized Redis for Memory Agent caching
2025-05-30 03:15:08,739 - src.infrastructure.kafka_client - INFO - Kafka producer initialized for nis-kafka:9092
2025-05-30 03:15:08,739 - src.agents.memory_agent - INFO - Initialized Kafka for Memory Agent events
2025-05-30 03:15:08,740 - src.agents.memory_agent - INFO - Memory Agent initialized with storage at outputs/memory
2025-05-30 03:15:08,741 - src.agents.action_agent - INFO - Action Agent initialized with output dir at outputs/findings
2025-05-30 03:15:23,197 - src.meta.coordinator - INFO - Registered protocol adapter: mcp
2025-05-30 03:15:23,199 - src.meta.coordinator - INFO - Registered protocol adapter: acp
2025-05-30 03:15:23,199 - src.meta.coordinator - INFO - Registered protocol adapter: a2a
2025-05-30 03:15:23,199 - src.meta.coordinator - INFO - Registered agent: vision_agent
2025-05-30 03:15:23,199 - src.meta.coordinator - INFO - Registered agent: reasoning_agent
2025-05-30 03:15:23,200 - src.meta.coordinator - INFO - Registered agent: memory_agent
2025-05-30 03:15:23,200 - src.meta.coordinator - INFO - Registered agent: action_agent
2025-05-30 03:15:23,221 - api.agent_integrator - INFO - LangGraph workflow compiled.
2025-05-30 03:15:23,221 - api.agent_integrator - INFO - NIS Protocol agents, coordinator, and graph initialized successfully
2025-05-30 03:15:23,274 - src.main - INFO - Application startup: Initializing resources...
2025-05-30 03:15:23,274 - src.main - INFO - Redis client initialized and attached to app_param.state.redis
2025-05-30 03:15:23,275 - src.main - INFO - StatisticsCollector initialized and attached to app_param.state.stats_collector
2025-05-30 03:15:23,275 - src.infrastructure.health_monitoring - INFO - HealthMonitor starting up...
2025-05-30 03:15:23,276 - src.infrastructure.distributed_processing - INFO - Starting Dask client in local mode...
2025-05-30 03:15:23,276 - src.infrastructure.distributed_processing - INFO - Setting up local Dask cluster...
2025-05-30 03:15:28,091 - src.infrastructure.distributed_processing - INFO - LocalCluster initialized: LocalCluster(4497407d, 'tcp://127.0.0.1:37857', workers=8, threads=16, memory=7.66 GiB)
2025-05-30 03:15:28,303 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client type after sync init: <class 'distributed.client.Client'>
2025-05-30 03:15:28,306 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client dir after sync init: ['_Client__loop', '__aenter__', '__aexit__', '__annotations__', '__await__', '__class__', '__del__', '__delattr__', '__dict__', '__dir__', '__doc__', '__enter__', '__eq__', '__exit__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_asynchronous', '_cancel', '_close', '_connecting_to_scheduler', '_dec_ref', '_default_event_handlers', '_deserializers', '_dump_cluster_state', '_ensure_connected', '_event_handlers', '_expand_key', '_gather', '_gather_future', '_gather_keys', '_gather_remote', '_gather_semaphore', '_get_components_from_future', '_get_computation_code', '_get_dataset', '_get_errored_future', '_get_raw_components_from_future', '_get_scheduler_info', '_get_task_stream', '_get_versions', '_graph_to_futures', '_handle_cancelled_keys', '_handle_error', '_handle_event', '_handle_forwarded_log_record', '_handle_key_in_memory', '_handle_lost_data', '_handle_report', '_handle_report_task', '_handle_restart', '_handle_retried_key', '_handle_task_erred', '_heartbeat', '_inc_ref', '_instances', '_loop_runner', '_optimize_insert_futures', '_pending_msg_buffer', '_periodic_callbacks', '_prepare_raw_components', '_profile', '_publish_dataset', '_rebalance', '_reconnect', '_refcount_lock', '_register_scheduler_plugin', '_register_worker_plugin', '_release_key', '_replicate', '_repr_html_', '_restart', '_restart_workers', '_retry', '_run', '_run_on_scheduler', '_scatter', '_scheduler_identity', '_send_to_scheduler', '_send_to_scheduler_safe', '_serializers', '_set_as_default', '_set_config', '_shutdown', '_start', '_start_arg', '_startup_kwargs', '_state_handlers', '_story', '_stream_handlers', '_timeout', '_unregister_worker_plugin', '_update_scheduler_info', '_upload_large_file', '_wait_for_handle_report_task', '_wait_for_workers', 'amm', 'as_current', 'asynchronous', 'benchmark_hardware', 'call_stack', 'cancel', 'close', 'cluster', 'collections_to_dsk', 'compute', 'connection_args', 'current', 'dashboard_link', 'datasets', 'direct_to_workers', 'dump_cluster_state', 'extensions', 'forward_logging', 'futures', 'futures_of', 'gather', 'generation', 'get', 'get_dataset', 'get_events', 'get_executor', 'get_metadata', 'get_scheduler_logs', 'get_task_stream', 'get_versions', 'get_worker_logs', 'has_what', 'id', 'io_loop', 'list_datasets', 'log_event', 'loop', 'map', 'nbytes', 'ncores', 'normalize_collection', 'nthreads', 'persist', 'preloads', 'processing', 'profile', 'publish_dataset', 'rebalance', 'recreate_error_locally', 'recreate_task_locally', 'refcount', 'register_scheduler_plugin', 'register_worker_callbacks', 'register_worker_plugin', 'replicate', 'restart', 'restart_workers', 'retire_workers', 'retry', 'rpc', 'run', 'run_on_scheduler', 'scatter', 'scheduler', 'scheduler_comm', 'scheduler_file', 'scheduler_info', 'security', 'set_metadata', 'shutdown', 'start', 'status', 'story', 'submit', 'subscribe_topic', 'sync', 'unforward_logging', 'unpublish_dataset', 'unregister_worker_plugin', 'unsubscribe_topic', 'upload_file', 'wait_for_workers', 'who_has', 'write_scheduler_file']
2025-05-30 03:15:28,310 - src.infrastructure.distributed_processing - INFO - Dask LocalCluster started and client connected: http://127.0.0.1:34727/status
2025-05-30 03:15:28,312 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager started successfully.
2025-05-30 03:15:28,314 - src.main - INFO - HealthMonitor initialized and Dask started, attached to app_param.state.health_monitor
2025-05-30 03:15:28,320 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.analysis.events
2025-05-30 03:15:28,321 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.batch.events
2025-05-30 03:15:33,325 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.analysis.events starting poll loop after delay.
2025-05-30 03:15:33,326 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.batch.events starting poll loop after delay.
2025-05-30 03:15:36,876 - api.analyze - INFO - Analyzing coordinates 34.0522, -118.2437 with data sources: {'satellite': True, 'lidar': True, 'historicalTexts': True, 'indigenousMaps': True}
2025-05-30 03:15:36,915 - api.agent_integrator - INFO - Executing Vision Analysis Node (Iteration: 0)
2025-05-30 03:15:36,917 - src.agents.vision_agent - ERROR - Error processing satellite data: Satellite tile not found: data/satellite/tile_340_1182.tif.
2025-05-30 03:15:36,925 - src.agents.vision_agent - ERROR - Error processing LIDAR data: LIDAR tile not found: data/lidar/tile_340_1182.tif.
2025-05-30 03:15:36,936 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 0)
2025-05-30 03:15:36,941 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 0)
2025-05-30 03:15:36,943 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:15:36,943 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 0
2025-05-30 03:15:36,943 - src.agents.action_agent - INFO - Strategy: Very low confidence (0.1). Expanding pattern search.
2025-05-30 03:15:36,944 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 0)
2025-05-30 03:15:36,946 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 1)
2025-05-30 03:15:36,947 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:15:36,947 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 1
2025-05-30 03:15:36,947 - src.agents.action_agent - INFO - Strategy: Very low confidence (0.1). Expanding pattern search.
2025-05-30 03:15:36,948 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 1)
2025-05-30 03:15:36,952 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 2)
2025-05-30 03:15:36,953 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:15:36,953 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 2
2025-05-30 03:15:36,953 - src.agents.action_agent - INFO - Strategy: Very low confidence (0.1). Expanding pattern search.
2025-05-30 03:15:36,954 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 2)
2025-05-30 03:15:36,955 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 3)
2025-05-30 03:15:36,956 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:15:36,956 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 3
2025-05-30 03:15:36,956 - src.agents.action_agent - INFO - Strategy: Max iterations reached or high confidence. Finalizing. Confidence: 0.1
2025-05-30 03:15:36,957 - src.agents.memory_agent - INFO - MemoryAgent.recall_context called with visual_data keys: ['location', 'satellite_findings', 'lidar_findings', 'combined_analysis']
2025-05-30 03:15:36,979 - src.agents.memory_agent - INFO - No sites found with pattern type: generic_placeholder_pattern
2025-05-30 03:15:36,979 - api.agent_integrator - INFO - [Consciousness Node] Integrated info: {'synthesis': 'Mock synthesis of visual and contextual memory.', 'visual_data': {'location': {'lat': 34.0522, 'lon': -118.2437}, 'satellite_findings': {'anomaly_detected': False, 'confidence': 0.3459551427904827, 'pattern_type': '', 'source': 'Sentinel-2 Scene ID: S2A_MSIL2A_20224758'}, 'lidar_findings': {'anomaly_detected': True, 'confidence': 0.848514548120631, 'pattern_type': 'circular geometric structures', 'source': 'Earth Archive LIDAR Tile #24657'}, 'combined_analysis': {'confidence': 0.546978904922542, 'features_detected': [], 'analysis_method': 'Multi-Modal Fusion', 'recommendation': 'High likelihood of archaeological features. Recommended for detailed archaeological survey.'}}, 'contextual_memories': {'similar_sites_in_region': [], 'historical_events_nearby': [], 'notes': 'Context recall is currently a basic placeholder.'}, 'confidence': 0.5}
2025-05-30 03:15:36,982 - api.agent_integrator - INFO - Executing Final Report Generation Node
2025-05-30 03:15:36,991 - src.agents.memory_agent - INFO - Stored data for site at 34.0522, -118.2437 with ID site_34p0522_n118p2437
2025-05-30 03:15:36,992 - src.agents.action_agent - INFO - Successfully stored finding f8bd24c2 in MemoryAgent.
2025-05-30 03:15:36,993 - src.agents.action_agent - INFO - Saved finding report to outputs/findings/finding_f8bd24c2_34.0522_-118.2437.json
2025-05-30 03:15:44,804 - src.main - INFO - Application shutdown: Cleaning up resources...
2025-05-30 03:15:44,805 - src.infrastructure.health_monitoring - INFO - HealthMonitor shutting down...
2025-05-30 03:15:44,806 - src.infrastructure.distributed_processing - INFO - Shutting down Dask client and cluster...
2025-05-30 03:15:44,819 - src.infrastructure.distributed_processing - ERROR - Error closing Dask client: object NoneType can't be used in 'await' expression
2025-05-30 03:15:45,466 - src.infrastructure.distributed_processing - INFO - Dask cluster closed.
2025-05-30 03:15:45,467 - src.infrastructure.distributed_processing - INFO - Dask shutdown complete.
2025-05-30 03:15:45,467 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager shut down successfully.
2025-05-30 03:15:45,468 - src.infrastructure.redis_client - INFO - Redis connection closed
2025-05-30 03:15:45,468 - src.main - INFO - Redis client connection closed.
2025-05-30 03:15:45,469 - src.main - INFO - Application shutdown complete.
2025-05-30 03:16:03,898 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:16:03,911 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:16:04,498 - src.meta.coordinator - INFO - MetaProtocolCoordinator initialized
2025-05-30 03:16:05,597 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:16:05,601 - src.agents.vision_agent - INFO - Vision Agent initialized with GPTIntegration (gpt-4-turbo)
2025-05-30 03:16:05,604 - src.agents.reasoning_agent - INFO - Loaded reasoning prompt from src/prompts/reasoning_prompt.txt
2025-05-30 03:16:07,957 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:16:07,964 - src.agents.reasoning_agent - INFO - Initialized GPT integration with model: gpt-4-turbo
2025-05-30 03:16:07,964 - src.agents.reasoning_agent - INFO - Reasoning Agent initialized
2025-05-30 03:16:10,639 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:16:10,641 - src.agents.memory_agent - INFO - Initialized GPT integration for Memory Agent with model: gpt-4o
2025-05-30 03:16:10,645 - src.infrastructure.redis_client - INFO - Connected to Redis at nis-redis:6379
2025-05-30 03:16:10,645 - src.agents.memory_agent - INFO - Initialized Redis for Memory Agent caching
2025-05-30 03:16:10,652 - src.infrastructure.kafka_client - INFO - Kafka producer initialized for nis-kafka:9092
2025-05-30 03:16:10,653 - src.agents.memory_agent - INFO - Initialized Kafka for Memory Agent events
2025-05-30 03:16:10,654 - src.agents.memory_agent - INFO - Memory Agent initialized with storage at outputs/memory
2025-05-30 03:16:10,654 - src.agents.action_agent - INFO - Action Agent initialized with output dir at outputs/findings
2025-05-30 03:16:21,552 - src.meta.coordinator - INFO - Registered protocol adapter: mcp
2025-05-30 03:16:21,554 - src.meta.coordinator - INFO - Registered protocol adapter: acp
2025-05-30 03:16:21,554 - src.meta.coordinator - INFO - Registered protocol adapter: a2a
2025-05-30 03:16:21,554 - src.meta.coordinator - INFO - Registered agent: vision_agent
2025-05-30 03:16:21,554 - src.meta.coordinator - INFO - Registered agent: reasoning_agent
2025-05-30 03:16:21,554 - src.meta.coordinator - INFO - Registered agent: memory_agent
2025-05-30 03:16:21,556 - src.meta.coordinator - INFO - Registered agent: action_agent
2025-05-30 03:16:21,592 - api.agent_integrator - INFO - LangGraph workflow compiled.
2025-05-30 03:16:21,593 - api.agent_integrator - INFO - NIS Protocol agents, coordinator, and graph initialized successfully
2025-05-30 03:16:21,687 - src.main - INFO - Application startup: Initializing resources...
2025-05-30 03:16:21,688 - src.main - INFO - Redis client initialized and attached to app_param.state.redis
2025-05-30 03:16:21,690 - src.main - INFO - StatisticsCollector initialized and attached to app_param.state.stats_collector
2025-05-30 03:16:21,691 - src.infrastructure.health_monitoring - INFO - HealthMonitor starting up...
2025-05-30 03:16:21,694 - src.infrastructure.distributed_processing - INFO - Starting Dask client in local mode...
2025-05-30 03:16:21,695 - src.infrastructure.distributed_processing - INFO - Setting up local Dask cluster...
2025-05-30 03:16:24,739 - src.infrastructure.distributed_processing - INFO - LocalCluster initialized: LocalCluster(46a89f4a, 'tcp://127.0.0.1:43791', workers=8, threads=16, memory=7.66 GiB)
2025-05-30 03:16:24,894 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client type after sync init: <class 'distributed.client.Client'>
2025-05-30 03:16:24,899 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client dir after sync init: ['_Client__loop', '__aenter__', '__aexit__', '__annotations__', '__await__', '__class__', '__del__', '__delattr__', '__dict__', '__dir__', '__doc__', '__enter__', '__eq__', '__exit__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_asynchronous', '_cancel', '_close', '_connecting_to_scheduler', '_dec_ref', '_default_event_handlers', '_deserializers', '_dump_cluster_state', '_ensure_connected', '_event_handlers', '_expand_key', '_gather', '_gather_future', '_gather_keys', '_gather_remote', '_gather_semaphore', '_get_components_from_future', '_get_computation_code', '_get_dataset', '_get_errored_future', '_get_raw_components_from_future', '_get_scheduler_info', '_get_task_stream', '_get_versions', '_graph_to_futures', '_handle_cancelled_keys', '_handle_error', '_handle_event', '_handle_forwarded_log_record', '_handle_key_in_memory', '_handle_lost_data', '_handle_report', '_handle_report_task', '_handle_restart', '_handle_retried_key', '_handle_task_erred', '_heartbeat', '_inc_ref', '_instances', '_loop_runner', '_optimize_insert_futures', '_pending_msg_buffer', '_periodic_callbacks', '_prepare_raw_components', '_profile', '_publish_dataset', '_rebalance', '_reconnect', '_refcount_lock', '_register_scheduler_plugin', '_register_worker_plugin', '_release_key', '_replicate', '_repr_html_', '_restart', '_restart_workers', '_retry', '_run', '_run_on_scheduler', '_scatter', '_scheduler_identity', '_send_to_scheduler', '_send_to_scheduler_safe', '_serializers', '_set_as_default', '_set_config', '_shutdown', '_start', '_start_arg', '_startup_kwargs', '_state_handlers', '_story', '_stream_handlers', '_timeout', '_unregister_worker_plugin', '_update_scheduler_info', '_upload_large_file', '_wait_for_handle_report_task', '_wait_for_workers', 'amm', 'as_current', 'asynchronous', 'benchmark_hardware', 'call_stack', 'cancel', 'close', 'cluster', 'collections_to_dsk', 'compute', 'connection_args', 'current', 'dashboard_link', 'datasets', 'direct_to_workers', 'dump_cluster_state', 'extensions', 'forward_logging', 'futures', 'futures_of', 'gather', 'generation', 'get', 'get_dataset', 'get_events', 'get_executor', 'get_metadata', 'get_scheduler_logs', 'get_task_stream', 'get_versions', 'get_worker_logs', 'has_what', 'id', 'io_loop', 'list_datasets', 'log_event', 'loop', 'map', 'nbytes', 'ncores', 'normalize_collection', 'nthreads', 'persist', 'preloads', 'processing', 'profile', 'publish_dataset', 'rebalance', 'recreate_error_locally', 'recreate_task_locally', 'refcount', 'register_scheduler_plugin', 'register_worker_callbacks', 'register_worker_plugin', 'replicate', 'restart', 'restart_workers', 'retire_workers', 'retry', 'rpc', 'run', 'run_on_scheduler', 'scatter', 'scheduler', 'scheduler_comm', 'scheduler_file', 'scheduler_info', 'security', 'set_metadata', 'shutdown', 'start', 'status', 'story', 'submit', 'subscribe_topic', 'sync', 'unforward_logging', 'unpublish_dataset', 'unregister_worker_plugin', 'unsubscribe_topic', 'upload_file', 'wait_for_workers', 'who_has', 'write_scheduler_file']
2025-05-30 03:16:24,901 - src.infrastructure.distributed_processing - INFO - Dask LocalCluster started and client connected: http://127.0.0.1:43709/status
2025-05-30 03:16:24,902 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager started successfully.
2025-05-30 03:16:24,903 - src.main - INFO - HealthMonitor initialized and Dask started, attached to app_param.state.health_monitor
2025-05-30 03:16:24,913 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.analysis.events
2025-05-30 03:16:24,919 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.batch.events
2025-05-30 03:16:29,916 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.analysis.events starting poll loop after delay.
2025-05-30 03:16:29,923 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.batch.events starting poll loop after delay.
2025-05-30 03:16:46,557 - api.statistics - ERROR - Error getting batch statistics: 404: Batch test_batch not found
2025-05-30 03:22:31,194 - src.main - INFO - Application shutdown: Cleaning up resources...
2025-05-30 03:22:31,197 - src.infrastructure.health_monitoring - INFO - HealthMonitor shutting down...
2025-05-30 03:22:31,199 - src.infrastructure.distributed_processing - INFO - Shutting down Dask client and cluster...
2025-05-30 03:22:31,213 - src.infrastructure.distributed_processing - ERROR - Error closing Dask client: object NoneType can't be used in 'await' expression
2025-05-30 03:22:31,843 - src.infrastructure.distributed_processing - INFO - Dask cluster closed.
2025-05-30 03:22:31,845 - src.infrastructure.distributed_processing - INFO - Dask shutdown complete.
2025-05-30 03:22:31,845 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager shut down successfully.
2025-05-30 03:22:31,848 - src.infrastructure.redis_client - INFO - Redis connection closed
2025-05-30 03:22:31,849 - src.main - INFO - Redis client connection closed.
2025-05-30 03:22:31,849 - src.main - INFO - Application shutdown complete.
2025-05-30 03:22:50,788 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:22:50,791 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:22:51,236 - src.meta.coordinator - INFO - MetaProtocolCoordinator initialized
2025-05-30 03:22:52,304 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:22:52,335 - src.agents.vision_agent - INFO - Vision Agent initialized with GPTIntegration (gpt-4-turbo)
2025-05-30 03:22:52,336 - src.agents.reasoning_agent - INFO - Loaded reasoning prompt from src/prompts/reasoning_prompt.txt
2025-05-30 03:22:53,582 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:22:53,583 - src.agents.reasoning_agent - INFO - Initialized GPT integration with model: gpt-4-turbo
2025-05-30 03:22:53,583 - src.agents.reasoning_agent - INFO - Reasoning Agent initialized
2025-05-30 03:22:54,293 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:22:54,298 - src.agents.memory_agent - INFO - Initialized GPT integration for Memory Agent with model: gpt-4o
2025-05-30 03:22:54,305 - src.infrastructure.redis_client - INFO - Connected to Redis at nis-redis:6379
2025-05-30 03:22:54,305 - src.agents.memory_agent - INFO - Initialized Redis for Memory Agent caching
2025-05-30 03:22:54,316 - src.infrastructure.kafka_client - INFO - Kafka producer initialized for nis-kafka:9092
2025-05-30 03:22:54,317 - src.agents.memory_agent - INFO - Initialized Kafka for Memory Agent events
2025-05-30 03:22:54,317 - src.agents.memory_agent - INFO - Memory Agent initialized with storage at outputs/memory
2025-05-30 03:22:54,318 - src.agents.action_agent - INFO - Action Agent initialized with output dir at outputs/findings
2025-05-30 03:23:06,628 - src.meta.coordinator - INFO - Registered protocol adapter: mcp
2025-05-30 03:23:06,631 - src.meta.coordinator - INFO - Registered protocol adapter: acp
2025-05-30 03:23:06,631 - src.meta.coordinator - INFO - Registered protocol adapter: a2a
2025-05-30 03:23:06,631 - src.meta.coordinator - INFO - Registered agent: vision_agent
2025-05-30 03:23:06,632 - src.meta.coordinator - INFO - Registered agent: reasoning_agent
2025-05-30 03:23:06,632 - src.meta.coordinator - INFO - Registered agent: memory_agent
2025-05-30 03:23:06,632 - src.meta.coordinator - INFO - Registered agent: action_agent
2025-05-30 03:23:06,699 - api.agent_integrator - INFO - LangGraph workflow compiled.
2025-05-30 03:23:06,700 - api.agent_integrator - INFO - NIS Protocol agents, coordinator, and graph initialized successfully
2025-05-30 03:23:06,834 - src.main - INFO - Application startup: Initializing resources...
2025-05-30 03:23:06,834 - src.main - INFO - Redis client initialized and attached to app_param.state.redis
2025-05-30 03:23:06,835 - src.main - INFO - StatisticsCollector initialized and attached to app_param.state.stats_collector
2025-05-30 03:23:06,836 - src.infrastructure.health_monitoring - INFO - HealthMonitor starting up...
2025-05-30 03:23:06,837 - src.infrastructure.distributed_processing - INFO - Starting Dask client in local mode...
2025-05-30 03:23:06,838 - src.infrastructure.distributed_processing - INFO - Setting up local Dask cluster...
2025-05-30 03:23:10,881 - src.infrastructure.distributed_processing - INFO - LocalCluster initialized: LocalCluster(44ccc224, 'tcp://127.0.0.1:38447', workers=8, threads=16, memory=7.66 GiB)
2025-05-30 03:23:10,911 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client type after sync init: <class 'distributed.client.Client'>
2025-05-30 03:23:10,913 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client dir after sync init: ['_Client__loop', '__aenter__', '__aexit__', '__annotations__', '__await__', '__class__', '__del__', '__delattr__', '__dict__', '__dir__', '__doc__', '__enter__', '__eq__', '__exit__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_asynchronous', '_cancel', '_close', '_connecting_to_scheduler', '_dec_ref', '_default_event_handlers', '_deserializers', '_dump_cluster_state', '_ensure_connected', '_event_handlers', '_expand_key', '_gather', '_gather_future', '_gather_keys', '_gather_remote', '_gather_semaphore', '_get_components_from_future', '_get_computation_code', '_get_dataset', '_get_errored_future', '_get_raw_components_from_future', '_get_scheduler_info', '_get_task_stream', '_get_versions', '_graph_to_futures', '_handle_cancelled_keys', '_handle_error', '_handle_event', '_handle_forwarded_log_record', '_handle_key_in_memory', '_handle_lost_data', '_handle_report', '_handle_report_task', '_handle_restart', '_handle_retried_key', '_handle_task_erred', '_heartbeat', '_inc_ref', '_instances', '_loop_runner', '_optimize_insert_futures', '_pending_msg_buffer', '_periodic_callbacks', '_prepare_raw_components', '_profile', '_publish_dataset', '_rebalance', '_reconnect', '_refcount_lock', '_register_scheduler_plugin', '_register_worker_plugin', '_release_key', '_replicate', '_repr_html_', '_restart', '_restart_workers', '_retry', '_run', '_run_on_scheduler', '_scatter', '_scheduler_identity', '_send_to_scheduler', '_send_to_scheduler_safe', '_serializers', '_set_as_default', '_set_config', '_shutdown', '_start', '_start_arg', '_startup_kwargs', '_state_handlers', '_story', '_stream_handlers', '_timeout', '_unregister_worker_plugin', '_update_scheduler_info', '_upload_large_file', '_wait_for_handle_report_task', '_wait_for_workers', 'amm', 'as_current', 'asynchronous', 'benchmark_hardware', 'call_stack', 'cancel', 'close', 'cluster', 'collections_to_dsk', 'compute', 'connection_args', 'current', 'dashboard_link', 'datasets', 'direct_to_workers', 'dump_cluster_state', 'extensions', 'forward_logging', 'futures', 'futures_of', 'gather', 'generation', 'get', 'get_dataset', 'get_events', 'get_executor', 'get_metadata', 'get_scheduler_logs', 'get_task_stream', 'get_versions', 'get_worker_logs', 'has_what', 'id', 'io_loop', 'list_datasets', 'log_event', 'loop', 'map', 'nbytes', 'ncores', 'normalize_collection', 'nthreads', 'persist', 'preloads', 'processing', 'profile', 'publish_dataset', 'rebalance', 'recreate_error_locally', 'recreate_task_locally', 'refcount', 'register_scheduler_plugin', 'register_worker_callbacks', 'register_worker_plugin', 'replicate', 'restart', 'restart_workers', 'retire_workers', 'retry', 'rpc', 'run', 'run_on_scheduler', 'scatter', 'scheduler', 'scheduler_comm', 'scheduler_file', 'scheduler_info', 'security', 'set_metadata', 'shutdown', 'start', 'status', 'story', 'submit', 'subscribe_topic', 'sync', 'unforward_logging', 'unpublish_dataset', 'unregister_worker_plugin', 'unsubscribe_topic', 'upload_file', 'wait_for_workers', 'who_has', 'write_scheduler_file']
2025-05-30 03:23:10,915 - src.infrastructure.distributed_processing - INFO - Dask LocalCluster started and client connected: http://127.0.0.1:38091/status
2025-05-30 03:23:10,915 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager started successfully.
2025-05-30 03:23:10,916 - src.main - INFO - HealthMonitor initialized and Dask started, attached to app_param.state.health_monitor
2025-05-30 03:23:10,919 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.analysis.events
2025-05-30 03:23:10,922 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.batch.events
2025-05-30 03:23:11,008 - api.analyze - INFO - Analyzing coordinates 10.0, -75.0 with data sources: {'satellite': True, 'lidar': True, 'historicalTexts': True, 'indigenousMaps': True}
2025-05-30 03:23:11,023 - api.agent_integrator - INFO - Executing Vision Analysis Node (Iteration: 0)
2025-05-30 03:23:11,025 - src.agents.vision_agent - WARNING - Satellite tile not found: data/satellite/tile_100_750.tif. Generating mock results.
2025-05-30 03:23:11,032 - src.agents.vision_agent - WARNING - LIDAR tile not found: data/lidar/tile_100_750.tif. Generating mock results.
2025-05-30 03:23:11,042 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 0)
2025-05-30 03:23:11,128 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 0)
2025-05-30 03:23:11,130 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:23:11,131 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 0
2025-05-30 03:23:11,131 - src.agents.action_agent - INFO - Strategy: Very low confidence (0.1). Expanding pattern search.
2025-05-30 03:23:11,132 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 0)
2025-05-30 03:23:11,138 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 1)
2025-05-30 03:23:11,140 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:23:11,141 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 1
2025-05-30 03:23:11,142 - src.agents.action_agent - INFO - Strategy: Very low confidence (0.1). Expanding pattern search.
2025-05-30 03:23:11,146 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 1)
2025-05-30 03:23:11,148 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 2)
2025-05-30 03:23:11,149 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:23:11,150 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 2
2025-05-30 03:23:11,153 - src.agents.action_agent - INFO - Strategy: Very low confidence (0.1). Expanding pattern search.
2025-05-30 03:23:11,154 - api.agent_integrator - INFO - Executing Pattern Detection Node (Iteration: 2)
2025-05-30 03:23:11,160 - api.agent_integrator - INFO - Executing Reasoning Node (Iteration: 3)
2025-05-30 03:23:11,163 - api.agent_integrator - INFO - Executing Action Strategy Node
2025-05-30 03:23:11,164 - src.agents.action_agent - INFO - ActionAgent strategizing next step. Iteration: 3
2025-05-30 03:23:11,167 - src.agents.action_agent - INFO - Strategy: Max iterations reached or high confidence. Finalizing. Confidence: 0.1
2025-05-30 03:23:11,202 - src.agents.memory_agent - INFO - MemoryAgent.recall_context called with visual_data keys: ['location', 'satellite_findings', 'lidar_findings', 'combined_analysis']
2025-05-30 03:23:11,215 - src.agents.memory_agent - INFO - No sites found with pattern type: generic_placeholder_pattern
2025-05-30 03:23:11,215 - api.agent_integrator - INFO - [Consciousness Node] Integrated info: {'synthesis': 'Mock synthesis of visual and contextual memory.', 'visual_data': {'location': {'lat': 10.0, 'lon': -75.0}, 'satellite_findings': {'anomaly_detected': True, 'confidence': 0.737548686551246, 'pattern_type': 'rectangular settlement patterns', 'source': 'Sentinel-2 Scene ID: S2A_MSIL2A_20221359'}, 'lidar_findings': {'anomaly_detected': False, 'confidence': 0.349209745086679, 'pattern_type': '', 'source': 'Earth Archive LIDAR Tile #91258'}, 'combined_analysis': {'confidence': 0.5822131099654192, 'features_detected': [], 'analysis_method': 'Multi-Modal Fusion', 'recommendation': 'High likelihood of archaeological features. Recommended for detailed archaeological survey.'}}, 'contextual_memories': {'similar_sites_in_region': [], 'historical_events_nearby': [], 'notes': 'Context recall is currently a basic placeholder.'}, 'confidence': 0.5}
2025-05-30 03:23:11,216 - api.agent_integrator - INFO - Executing Final Report Generation Node
2025-05-30 03:23:11,243 - src.agents.memory_agent - INFO - Stored data for site at 10.0, -75.0 with ID site_10p0000_n75p0000
2025-05-30 03:23:11,248 - src.agents.action_agent - INFO - Successfully stored finding 13ecb49f in MemoryAgent.
2025-05-30 03:23:11,252 - src.agents.action_agent - INFO - Saved finding report to outputs/findings/finding_13ecb49f_10.0000_-75.0000.json
2025-05-30 03:23:15,923 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.analysis.events starting poll loop after delay.
2025-05-30 03:23:15,929 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.batch.events starting poll loop after delay.
2025-05-30 03:23:27,540 - src.main - INFO - Application shutdown: Cleaning up resources...
2025-05-30 03:23:27,543 - src.infrastructure.health_monitoring - INFO - HealthMonitor shutting down...
2025-05-30 03:23:27,544 - src.infrastructure.distributed_processing - INFO - Shutting down Dask client and cluster...
2025-05-30 03:23:27,555 - src.infrastructure.distributed_processing - ERROR - Error closing Dask client: object NoneType can't be used in 'await' expression
2025-05-30 03:23:28,199 - src.infrastructure.distributed_processing - INFO - Dask cluster closed.
2025-05-30 03:23:28,200 - src.infrastructure.distributed_processing - INFO - Dask shutdown complete.
2025-05-30 03:23:28,201 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager shut down successfully.
2025-05-30 03:23:28,202 - src.infrastructure.redis_client - INFO - Redis connection closed
2025-05-30 03:23:28,203 - src.main - INFO - Redis client connection closed.
2025-05-30 03:23:28,203 - src.main - INFO - Application shutdown complete.
2025-05-30 03:23:49,166 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:23:49,168 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:23:49,662 - src.meta.coordinator - INFO - MetaProtocolCoordinator initialized
2025-05-30 03:23:50,926 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:23:50,930 - src.agents.vision_agent - INFO - Vision Agent initialized with GPTIntegration (gpt-4-turbo)
2025-05-30 03:23:50,931 - src.agents.reasoning_agent - INFO - Loaded reasoning prompt from src/prompts/reasoning_prompt.txt
2025-05-30 03:23:51,640 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:23:51,642 - src.agents.reasoning_agent - INFO - Initialized GPT integration with model: gpt-4-turbo
2025-05-30 03:23:51,642 - src.agents.reasoning_agent - INFO - Reasoning Agent initialized
2025-05-30 03:23:52,297 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:23:52,298 - src.agents.memory_agent - INFO - Initialized GPT integration for Memory Agent with model: gpt-4o
2025-05-30 03:23:52,302 - src.infrastructure.redis_client - INFO - Connected to Redis at nis-redis:6379
2025-05-30 03:23:52,302 - src.agents.memory_agent - INFO - Initialized Redis for Memory Agent caching
2025-05-30 03:23:52,316 - src.infrastructure.kafka_client - INFO - Kafka producer initialized for nis-kafka:9092
2025-05-30 03:23:52,316 - src.agents.memory_agent - INFO - Initialized Kafka for Memory Agent events
2025-05-30 03:23:52,316 - src.agents.memory_agent - INFO - Memory Agent initialized with storage at outputs/memory
2025-05-30 03:23:52,317 - src.agents.action_agent - INFO - Action Agent initialized with output dir at outputs/findings
2025-05-30 03:24:04,940 - src.meta.coordinator - INFO - Registered protocol adapter: mcp
2025-05-30 03:24:04,941 - src.meta.coordinator - INFO - Registered protocol adapter: acp
2025-05-30 03:24:04,941 - src.meta.coordinator - INFO - Registered protocol adapter: a2a
2025-05-30 03:24:04,942 - src.meta.coordinator - INFO - Registered agent: vision_agent
2025-05-30 03:24:04,943 - src.meta.coordinator - INFO - Registered agent: reasoning_agent
2025-05-30 03:24:04,943 - src.meta.coordinator - INFO - Registered agent: memory_agent
2025-05-30 03:24:04,944 - src.meta.coordinator - INFO - Registered agent: action_agent
2025-05-30 03:24:04,986 - api.agent_integrator - INFO - LangGraph workflow compiled.
2025-05-30 03:24:04,987 - api.agent_integrator - INFO - NIS Protocol agents, coordinator, and graph initialized successfully
2025-05-30 03:24:05,159 - src.main - INFO - Application startup: Initializing resources...
2025-05-30 03:24:05,160 - src.main - INFO - Redis client initialized and attached to app_param.state.redis
2025-05-30 03:24:05,162 - src.main - INFO - StatisticsCollector initialized and attached to app_param.state.stats_collector
2025-05-30 03:24:05,162 - src.infrastructure.health_monitoring - INFO - HealthMonitor starting up...
2025-05-30 03:24:05,162 - src.infrastructure.distributed_processing - INFO - Starting Dask client in local mode...
2025-05-30 03:24:05,162 - src.infrastructure.distributed_processing - INFO - Setting up local Dask cluster...
2025-05-30 03:24:09,012 - src.infrastructure.distributed_processing - INFO - LocalCluster initialized: LocalCluster(bac3fc3d, 'tcp://127.0.0.1:45529', workers=8, threads=16, memory=7.66 GiB)
2025-05-30 03:24:09,052 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client type after sync init: <class 'distributed.client.Client'>
2025-05-30 03:24:09,053 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client dir after sync init: ['_Client__loop', '__aenter__', '__aexit__', '__annotations__', '__await__', '__class__', '__del__', '__delattr__', '__dict__', '__dir__', '__doc__', '__enter__', '__eq__', '__exit__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_asynchronous', '_cancel', '_close', '_connecting_to_scheduler', '_dec_ref', '_default_event_handlers', '_deserializers', '_dump_cluster_state', '_ensure_connected', '_event_handlers', '_expand_key', '_gather', '_gather_future', '_gather_keys', '_gather_remote', '_gather_semaphore', '_get_components_from_future', '_get_computation_code', '_get_dataset', '_get_errored_future', '_get_raw_components_from_future', '_get_scheduler_info', '_get_task_stream', '_get_versions', '_graph_to_futures', '_handle_cancelled_keys', '_handle_error', '_handle_event', '_handle_forwarded_log_record', '_handle_key_in_memory', '_handle_lost_data', '_handle_report', '_handle_report_task', '_handle_restart', '_handle_retried_key', '_handle_task_erred', '_heartbeat', '_inc_ref', '_instances', '_loop_runner', '_optimize_insert_futures', '_pending_msg_buffer', '_periodic_callbacks', '_prepare_raw_components', '_profile', '_publish_dataset', '_rebalance', '_reconnect', '_refcount_lock', '_register_scheduler_plugin', '_register_worker_plugin', '_release_key', '_replicate', '_repr_html_', '_restart', '_restart_workers', '_retry', '_run', '_run_on_scheduler', '_scatter', '_scheduler_identity', '_send_to_scheduler', '_send_to_scheduler_safe', '_serializers', '_set_as_default', '_set_config', '_shutdown', '_start', '_start_arg', '_startup_kwargs', '_state_handlers', '_story', '_stream_handlers', '_timeout', '_unregister_worker_plugin', '_update_scheduler_info', '_upload_large_file', '_wait_for_handle_report_task', '_wait_for_workers', 'amm', 'as_current', 'asynchronous', 'benchmark_hardware', 'call_stack', 'cancel', 'close', 'cluster', 'collections_to_dsk', 'compute', 'connection_args', 'current', 'dashboard_link', 'datasets', 'direct_to_workers', 'dump_cluster_state', 'extensions', 'forward_logging', 'futures', 'futures_of', 'gather', 'generation', 'get', 'get_dataset', 'get_events', 'get_executor', 'get_metadata', 'get_scheduler_logs', 'get_task_stream', 'get_versions', 'get_worker_logs', 'has_what', 'id', 'io_loop', 'list_datasets', 'log_event', 'loop', 'map', 'nbytes', 'ncores', 'normalize_collection', 'nthreads', 'persist', 'preloads', 'processing', 'profile', 'publish_dataset', 'rebalance', 'recreate_error_locally', 'recreate_task_locally', 'refcount', 'register_scheduler_plugin', 'register_worker_callbacks', 'register_worker_plugin', 'replicate', 'restart', 'restart_workers', 'retire_workers', 'retry', 'rpc', 'run', 'run_on_scheduler', 'scatter', 'scheduler', 'scheduler_comm', 'scheduler_file', 'scheduler_info', 'security', 'set_metadata', 'shutdown', 'start', 'status', 'story', 'submit', 'subscribe_topic', 'sync', 'unforward_logging', 'unpublish_dataset', 'unregister_worker_plugin', 'unsubscribe_topic', 'upload_file', 'wait_for_workers', 'who_has', 'write_scheduler_file']
2025-05-30 03:24:09,054 - src.infrastructure.distributed_processing - INFO - Dask LocalCluster started and client connected: http://127.0.0.1:40917/status
2025-05-30 03:24:09,056 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager started successfully.
2025-05-30 03:24:09,057 - src.main - INFO - HealthMonitor initialized and Dask started, attached to app_param.state.health_monitor
2025-05-30 03:24:09,062 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.analysis.events
2025-05-30 03:24:09,064 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.batch.events
2025-05-30 03:24:50,004 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:24:50,007 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:24:50,353 - src.meta.coordinator - INFO - MetaProtocolCoordinator initialized
2025-05-30 03:24:51,248 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:24:51,489 - src.agents.vision_agent - INFO - Vision Agent initialized with GPTIntegration (gpt-4-turbo)
2025-05-30 03:24:51,493 - src.agents.reasoning_agent - INFO - Loaded reasoning prompt from src/prompts/reasoning_prompt.txt
2025-05-30 03:24:52,255 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:24:52,256 - src.agents.reasoning_agent - INFO - Initialized GPT integration with model: gpt-4-turbo
2025-05-30 03:24:52,256 - src.agents.reasoning_agent - INFO - Reasoning Agent initialized
2025-05-30 03:24:54,108 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:24:54,110 - src.agents.memory_agent - INFO - Initialized GPT integration for Memory Agent with model: gpt-4o
2025-05-30 03:24:54,116 - src.infrastructure.redis_client - INFO - Connected to Redis at nis-redis:6379
2025-05-30 03:24:54,117 - src.agents.memory_agent - INFO - Initialized Redis for Memory Agent caching
2025-05-30 03:24:54,128 - src.infrastructure.kafka_client - INFO - Kafka producer initialized for nis-kafka:9092
2025-05-30 03:24:54,128 - src.agents.memory_agent - INFO - Initialized Kafka for Memory Agent events
2025-05-30 03:24:54,128 - src.agents.memory_agent - INFO - Memory Agent initialized with storage at outputs/memory
2025-05-30 03:24:54,129 - src.agents.action_agent - INFO - Action Agent initialized with output dir at outputs/findings
2025-05-30 03:25:04,942 - src.meta.coordinator - INFO - Registered protocol adapter: mcp
2025-05-30 03:25:04,946 - src.meta.coordinator - INFO - Registered protocol adapter: acp
2025-05-30 03:25:04,946 - src.meta.coordinator - INFO - Registered protocol adapter: a2a
2025-05-30 03:25:04,947 - src.meta.coordinator - INFO - Registered agent: vision_agent
2025-05-30 03:25:04,948 - src.meta.coordinator - INFO - Registered agent: reasoning_agent
2025-05-30 03:25:04,948 - src.meta.coordinator - INFO - Registered agent: memory_agent
2025-05-30 03:25:04,948 - src.meta.coordinator - INFO - Registered agent: action_agent
2025-05-30 03:25:05,019 - api.agent_integrator - INFO - LangGraph workflow compiled.
2025-05-30 03:25:05,019 - api.agent_integrator - INFO - NIS Protocol agents, coordinator, and graph initialized successfully
2025-05-30 03:25:05,488 - src.main - INFO - Application startup: Initializing resources...
2025-05-30 03:25:05,493 - src.main - INFO - Redis client initialized and attached to app_param.state.redis
2025-05-30 03:25:05,500 - src.main - INFO - StatisticsCollector initialized and attached to app_param.state.stats_collector
2025-05-30 03:25:05,500 - src.infrastructure.health_monitoring - INFO - HealthMonitor starting up...
2025-05-30 03:25:05,513 - src.infrastructure.distributed_processing - INFO - Starting Dask client in local mode...
2025-05-30 03:25:05,513 - src.infrastructure.distributed_processing - INFO - Setting up local Dask cluster...
2025-05-30 03:25:09,416 - src.infrastructure.distributed_processing - INFO - LocalCluster initialized: LocalCluster(96c03cce, 'tcp://127.0.0.1:34687', workers=8, threads=16, memory=7.66 GiB)
2025-05-30 03:25:09,451 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client type after sync init: <class 'distributed.client.Client'>
2025-05-30 03:25:09,452 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client dir after sync init: ['_Client__loop', '__aenter__', '__aexit__', '__annotations__', '__await__', '__class__', '__del__', '__delattr__', '__dict__', '__dir__', '__doc__', '__enter__', '__eq__', '__exit__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_asynchronous', '_cancel', '_close', '_connecting_to_scheduler', '_dec_ref', '_default_event_handlers', '_deserializers', '_dump_cluster_state', '_ensure_connected', '_event_handlers', '_expand_key', '_gather', '_gather_future', '_gather_keys', '_gather_remote', '_gather_semaphore', '_get_components_from_future', '_get_computation_code', '_get_dataset', '_get_errored_future', '_get_raw_components_from_future', '_get_scheduler_info', '_get_task_stream', '_get_versions', '_graph_to_futures', '_handle_cancelled_keys', '_handle_error', '_handle_event', '_handle_forwarded_log_record', '_handle_key_in_memory', '_handle_lost_data', '_handle_report', '_handle_report_task', '_handle_restart', '_handle_retried_key', '_handle_task_erred', '_heartbeat', '_inc_ref', '_instances', '_loop_runner', '_optimize_insert_futures', '_pending_msg_buffer', '_periodic_callbacks', '_prepare_raw_components', '_profile', '_publish_dataset', '_rebalance', '_reconnect', '_refcount_lock', '_register_scheduler_plugin', '_register_worker_plugin', '_release_key', '_replicate', '_repr_html_', '_restart', '_restart_workers', '_retry', '_run', '_run_on_scheduler', '_scatter', '_scheduler_identity', '_send_to_scheduler', '_send_to_scheduler_safe', '_serializers', '_set_as_default', '_set_config', '_shutdown', '_start', '_start_arg', '_startup_kwargs', '_state_handlers', '_story', '_stream_handlers', '_timeout', '_unregister_worker_plugin', '_update_scheduler_info', '_upload_large_file', '_wait_for_handle_report_task', '_wait_for_workers', 'amm', 'as_current', 'asynchronous', 'benchmark_hardware', 'call_stack', 'cancel', 'close', 'cluster', 'collections_to_dsk', 'compute', 'connection_args', 'current', 'dashboard_link', 'datasets', 'direct_to_workers', 'dump_cluster_state', 'extensions', 'forward_logging', 'futures', 'futures_of', 'gather', 'generation', 'get', 'get_dataset', 'get_events', 'get_executor', 'get_metadata', 'get_scheduler_logs', 'get_task_stream', 'get_versions', 'get_worker_logs', 'has_what', 'id', 'io_loop', 'list_datasets', 'log_event', 'loop', 'map', 'nbytes', 'ncores', 'normalize_collection', 'nthreads', 'persist', 'preloads', 'processing', 'profile', 'publish_dataset', 'rebalance', 'recreate_error_locally', 'recreate_task_locally', 'refcount', 'register_scheduler_plugin', 'register_worker_callbacks', 'register_worker_plugin', 'replicate', 'restart', 'restart_workers', 'retire_workers', 'retry', 'rpc', 'run', 'run_on_scheduler', 'scatter', 'scheduler', 'scheduler_comm', 'scheduler_file', 'scheduler_info', 'security', 'set_metadata', 'shutdown', 'start', 'status', 'story', 'submit', 'subscribe_topic', 'sync', 'unforward_logging', 'unpublish_dataset', 'unregister_worker_plugin', 'unsubscribe_topic', 'upload_file', 'wait_for_workers', 'who_has', 'write_scheduler_file']
2025-05-30 03:25:09,452 - src.infrastructure.distributed_processing - INFO - Dask LocalCluster started and client connected: http://127.0.0.1:44053/status
2025-05-30 03:25:09,453 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager started successfully.
2025-05-30 03:25:09,453 - src.main - INFO - HealthMonitor initialized and Dask started, attached to app_param.state.health_monitor
2025-05-30 03:25:09,455 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.analysis.events
2025-05-30 03:25:09,456 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.batch.events
2025-05-30 03:25:14,461 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.analysis.events starting poll loop after delay.
2025-05-30 03:25:14,461 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.batch.events starting poll loop after delay.
2025-05-30 03:29:41,553 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:29:41,555 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:29:41,907 - src.meta.coordinator - INFO - MetaProtocolCoordinator initialized
2025-05-30 03:29:42,983 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:29:42,986 - src.agents.vision_agent - INFO - Vision Agent initialized with GPTIntegration (gpt-4-turbo)
2025-05-30 03:29:42,986 - src.agents.reasoning_agent - INFO - Loaded reasoning prompt from src/prompts/reasoning_prompt.txt
2025-05-30 03:29:44,630 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:29:44,632 - src.agents.reasoning_agent - INFO - Initialized GPT integration with model: gpt-4-turbo
2025-05-30 03:29:44,632 - src.agents.reasoning_agent - INFO - Reasoning Agent initialized
2025-05-30 03:29:45,748 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:29:45,749 - src.agents.memory_agent - INFO - Initialized GPT integration for Memory Agent with model: gpt-4o
2025-05-30 03:29:45,755 - src.infrastructure.redis_client - INFO - Connected to Redis at nis-redis:6379
2025-05-30 03:29:45,756 - src.agents.memory_agent - INFO - Initialized Redis for Memory Agent caching
2025-05-30 03:29:45,772 - src.infrastructure.kafka_client - INFO - Kafka producer initialized for nis-kafka:9092
2025-05-30 03:29:45,772 - src.agents.memory_agent - INFO - Initialized Kafka for Memory Agent events
2025-05-30 03:29:45,773 - src.agents.memory_agent - INFO - Memory Agent initialized with storage at outputs/memory
2025-05-30 03:29:45,773 - src.agents.action_agent - INFO - Action Agent initialized with output dir at outputs/findings
2025-05-30 03:29:55,727 - src.meta.coordinator - INFO - Registered protocol adapter: mcp
2025-05-30 03:29:55,742 - src.meta.coordinator - INFO - Registered protocol adapter: acp
2025-05-30 03:29:55,743 - src.meta.coordinator - INFO - Registered protocol adapter: a2a
2025-05-30 03:29:55,743 - src.meta.coordinator - INFO - Registered agent: vision_agent
2025-05-30 03:29:55,743 - src.meta.coordinator - INFO - Registered agent: reasoning_agent
2025-05-30 03:29:55,743 - src.meta.coordinator - INFO - Registered agent: memory_agent
2025-05-30 03:29:55,743 - src.meta.coordinator - INFO - Registered agent: action_agent
2025-05-30 03:29:55,817 - api.agent_integrator - INFO - LangGraph workflow compiled.
2025-05-30 03:29:55,826 - api.agent_integrator - INFO - NIS Protocol agents, coordinator, and graph initialized successfully
2025-05-30 03:29:56,071 - src.main - INFO - Application startup: Initializing resources...
2025-05-30 03:29:56,079 - src.main - INFO - Redis client initialized and attached to app_param.state.redis
2025-05-30 03:29:56,080 - src.main - INFO - StatisticsCollector initialized and attached to app_param.state.stats_collector
2025-05-30 03:29:56,081 - src.infrastructure.health_monitoring - INFO - HealthMonitor starting up...
2025-05-30 03:29:56,081 - src.infrastructure.distributed_processing - INFO - Starting Dask client in local mode...
2025-05-30 03:29:56,087 - src.infrastructure.distributed_processing - INFO - Setting up local Dask cluster...
2025-05-30 03:30:00,849 - src.infrastructure.distributed_processing - INFO - LocalCluster initialized: LocalCluster(66613988, 'tcp://127.0.0.1:44287', workers=8, threads=16, memory=7.66 GiB)
2025-05-30 03:30:00,879 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client type after sync init: <class 'distributed.client.Client'>
2025-05-30 03:30:00,879 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client dir after sync init: ['_Client__loop', '__aenter__', '__aexit__', '__annotations__', '__await__', '__class__', '__del__', '__delattr__', '__dict__', '__dir__', '__doc__', '__enter__', '__eq__', '__exit__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_asynchronous', '_cancel', '_close', '_connecting_to_scheduler', '_dec_ref', '_default_event_handlers', '_deserializers', '_dump_cluster_state', '_ensure_connected', '_event_handlers', '_expand_key', '_gather', '_gather_future', '_gather_keys', '_gather_remote', '_gather_semaphore', '_get_components_from_future', '_get_computation_code', '_get_dataset', '_get_errored_future', '_get_raw_components_from_future', '_get_scheduler_info', '_get_task_stream', '_get_versions', '_graph_to_futures', '_handle_cancelled_keys', '_handle_error', '_handle_event', '_handle_forwarded_log_record', '_handle_key_in_memory', '_handle_lost_data', '_handle_report', '_handle_report_task', '_handle_restart', '_handle_retried_key', '_handle_task_erred', '_heartbeat', '_inc_ref', '_instances', '_loop_runner', '_optimize_insert_futures', '_pending_msg_buffer', '_periodic_callbacks', '_prepare_raw_components', '_profile', '_publish_dataset', '_rebalance', '_reconnect', '_refcount_lock', '_register_scheduler_plugin', '_register_worker_plugin', '_release_key', '_replicate', '_repr_html_', '_restart', '_restart_workers', '_retry', '_run', '_run_on_scheduler', '_scatter', '_scheduler_identity', '_send_to_scheduler', '_send_to_scheduler_safe', '_serializers', '_set_as_default', '_set_config', '_shutdown', '_start', '_start_arg', '_startup_kwargs', '_state_handlers', '_story', '_stream_handlers', '_timeout', '_unregister_worker_plugin', '_update_scheduler_info', '_upload_large_file', '_wait_for_handle_report_task', '_wait_for_workers', 'amm', 'as_current', 'asynchronous', 'benchmark_hardware', 'call_stack', 'cancel', 'close', 'cluster', 'collections_to_dsk', 'compute', 'connection_args', 'current', 'dashboard_link', 'datasets', 'direct_to_workers', 'dump_cluster_state', 'extensions', 'forward_logging', 'futures', 'futures_of', 'gather', 'generation', 'get', 'get_dataset', 'get_events', 'get_executor', 'get_metadata', 'get_scheduler_logs', 'get_task_stream', 'get_versions', 'get_worker_logs', 'has_what', 'id', 'io_loop', 'list_datasets', 'log_event', 'loop', 'map', 'nbytes', 'ncores', 'normalize_collection', 'nthreads', 'persist', 'preloads', 'processing', 'profile', 'publish_dataset', 'rebalance', 'recreate_error_locally', 'recreate_task_locally', 'refcount', 'register_scheduler_plugin', 'register_worker_callbacks', 'register_worker_plugin', 'replicate', 'restart', 'restart_workers', 'retire_workers', 'retry', 'rpc', 'run', 'run_on_scheduler', 'scatter', 'scheduler', 'scheduler_comm', 'scheduler_file', 'scheduler_info', 'security', 'set_metadata', 'shutdown', 'start', 'status', 'story', 'submit', 'subscribe_topic', 'sync', 'unforward_logging', 'unpublish_dataset', 'unregister_worker_plugin', 'unsubscribe_topic', 'upload_file', 'wait_for_workers', 'who_has', 'write_scheduler_file']
2025-05-30 03:30:00,880 - src.infrastructure.distributed_processing - INFO - Dask LocalCluster started and client connected: http://127.0.0.1:35951/status
2025-05-30 03:30:00,880 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager started successfully.
2025-05-30 03:30:00,881 - src.main - INFO - HealthMonitor initialized and Dask started, attached to app_param.state.health_monitor
2025-05-30 03:30:00,885 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.analysis.events
2025-05-30 03:30:00,886 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.batch.events
2025-05-30 03:30:00,916 - api.batch - ERROR - Error submitting batch analysis: 'State' object has no attribute 'kafka_producer'
2025-05-30 03:30:05,892 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.analysis.events starting poll loop after delay.
2025-05-30 03:30:05,893 - src.infrastructure.kafka_client - INFO - Consumer for topic nis.batch.events starting poll loop after delay.
2025-05-30 03:30:19,705 - src.main - INFO - Application shutdown: Cleaning up resources...
2025-05-30 03:30:19,707 - src.infrastructure.health_monitoring - INFO - HealthMonitor shutting down...
2025-05-30 03:30:19,708 - src.infrastructure.distributed_processing - INFO - Shutting down Dask client and cluster...
2025-05-30 03:30:19,718 - src.infrastructure.distributed_processing - ERROR - Error closing Dask client: object NoneType can't be used in 'await' expression
2025-05-30 03:30:20,369 - src.infrastructure.distributed_processing - INFO - Dask cluster closed.
2025-05-30 03:30:20,369 - src.infrastructure.distributed_processing - INFO - Dask shutdown complete.
2025-05-30 03:30:20,369 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager shut down successfully.
2025-05-30 03:30:20,371 - src.infrastructure.redis_client - INFO - Redis connection closed
2025-05-30 03:30:20,372 - src.main - INFO - Redis client connection closed.
2025-05-30 03:30:20,372 - src.main - INFO - Application shutdown complete.
2025-05-30 03:30:36,921 - src.main - INFO - --- LOGGER: src/main.py IS RUNNING (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:30:36,923 - src.main - INFO - --- LOGGER: FastAPI app object created (Stage 5 Test - Data/Monitor Imports) ---
2025-05-30 03:30:37,338 - src.meta.coordinator - INFO - MetaProtocolCoordinator initialized
2025-05-30 03:30:38,688 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:30:38,695 - src.agents.vision_agent - INFO - Vision Agent initialized with GPTIntegration (gpt-4-turbo)
2025-05-30 03:30:38,697 - src.agents.reasoning_agent - INFO - Loaded reasoning prompt from src/prompts/reasoning_prompt.txt
2025-05-30 03:30:39,708 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:30:39,709 - src.agents.reasoning_agent - INFO - Initialized GPT integration with model: gpt-4-turbo
2025-05-30 03:30:39,711 - src.agents.reasoning_agent - INFO - Reasoning Agent initialized
2025-05-30 03:30:40,427 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-30 03:30:40,428 - src.agents.memory_agent - INFO - Initialized GPT integration for Memory Agent with model: gpt-4o
2025-05-30 03:30:40,433 - src.infrastructure.redis_client - INFO - Connected to Redis at nis-redis:6379
2025-05-30 03:30:40,433 - src.agents.memory_agent - INFO - Initialized Redis for Memory Agent caching
2025-05-30 03:30:40,442 - src.infrastructure.kafka_client - INFO - Kafka producer initialized for nis-kafka:9092
2025-05-30 03:30:40,442 - src.agents.memory_agent - INFO - Initialized Kafka for Memory Agent events
2025-05-30 03:30:40,442 - src.agents.memory_agent - INFO - Memory Agent initialized with storage at outputs/memory
2025-05-30 03:30:40,444 - src.agents.action_agent - INFO - Action Agent initialized with output dir at outputs/findings
2025-05-30 03:30:48,921 - src.meta.coordinator - INFO - Registered protocol adapter: mcp
2025-05-30 03:30:48,923 - src.meta.coordinator - INFO - Registered protocol adapter: acp
2025-05-30 03:30:48,923 - src.meta.coordinator - INFO - Registered protocol adapter: a2a
2025-05-30 03:30:48,924 - src.meta.coordinator - INFO - Registered agent: vision_agent
2025-05-30 03:30:48,924 - src.meta.coordinator - INFO - Registered agent: reasoning_agent
2025-05-30 03:30:48,925 - src.meta.coordinator - INFO - Registered agent: memory_agent
2025-05-30 03:30:48,926 - src.meta.coordinator - INFO - Registered agent: action_agent
2025-05-30 03:30:48,959 - api.agent_integrator - INFO - LangGraph workflow compiled.
2025-05-30 03:30:48,960 - api.agent_integrator - INFO - NIS Protocol agents, coordinator, and graph initialized successfully
2025-05-30 03:30:49,074 - src.main - INFO - Application startup: Initializing resources...
2025-05-30 03:30:49,074 - src.main - INFO - Redis client initialized and attached to app_param.state.redis
2025-05-30 03:30:49,074 - src.main - INFO - StatisticsCollector initialized and attached to app_param.state.stats_collector
2025-05-30 03:30:49,074 - src.infrastructure.health_monitoring - INFO - HealthMonitor starting up...
2025-05-30 03:30:49,075 - src.infrastructure.distributed_processing - INFO - Starting Dask client in local mode...
2025-05-30 03:30:49,075 - src.infrastructure.distributed_processing - INFO - Setting up local Dask cluster...
2025-05-30 03:30:51,457 - src.infrastructure.distributed_processing - INFO - LocalCluster initialized: LocalCluster(2ae57bec, 'tcp://127.0.0.1:39861', workers=8, threads=16, memory=7.66 GiB)
2025-05-30 03:30:51,540 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client type after sync init: <class 'distributed.client.Client'>
2025-05-30 03:30:51,541 - src.infrastructure.distributed_processing - INFO - DEBUG: self.client dir after sync init: ['_Client__loop', '__aenter__', '__aexit__', '__annotations__', '__await__', '__class__', '__del__', '__delattr__', '__dict__', '__dir__', '__doc__', '__enter__', '__eq__', '__exit__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_asynchronous', '_cancel', '_close', '_connecting_to_scheduler', '_dec_ref', '_default_event_handlers', '_deserializers', '_dump_cluster_state', '_ensure_connected', '_event_handlers', '_expand_key', '_gather', '_gather_future', '_gather_keys', '_gather_remote', '_gather_semaphore', '_get_components_from_future', '_get_computation_code', '_get_dataset', '_get_errored_future', '_get_raw_components_from_future', '_get_scheduler_info', '_get_task_stream', '_get_versions', '_graph_to_futures', '_handle_cancelled_keys', '_handle_error', '_handle_event', '_handle_forwarded_log_record', '_handle_key_in_memory', '_handle_lost_data', '_handle_report', '_handle_report_task', '_handle_restart', '_handle_retried_key', '_handle_task_erred', '_heartbeat', '_inc_ref', '_instances', '_loop_runner', '_optimize_insert_futures', '_pending_msg_buffer', '_periodic_callbacks', '_prepare_raw_components', '_profile', '_publish_dataset', '_rebalance', '_reconnect', '_refcount_lock', '_register_scheduler_plugin', '_register_worker_plugin', '_release_key', '_replicate', '_repr_html_', '_restart', '_restart_workers', '_retry', '_run', '_run_on_scheduler', '_scatter', '_scheduler_identity', '_send_to_scheduler', '_send_to_scheduler_safe', '_serializers', '_set_as_default', '_set_config', '_shutdown', '_start', '_start_arg', '_startup_kwargs', '_state_handlers', '_story', '_stream_handlers', '_timeout', '_unregister_worker_plugin', '_update_scheduler_info', '_upload_large_file', '_wait_for_handle_report_task', '_wait_for_workers', 'amm', 'as_current', 'asynchronous', 'benchmark_hardware', 'call_stack', 'cancel', 'close', 'cluster', 'collections_to_dsk', 'compute', 'connection_args', 'current', 'dashboard_link', 'datasets', 'direct_to_workers', 'dump_cluster_state', 'extensions', 'forward_logging', 'futures', 'futures_of', 'gather', 'generation', 'get', 'get_dataset', 'get_events', 'get_executor', 'get_metadata', 'get_scheduler_logs', 'get_task_stream', 'get_versions', 'get_worker_logs', 'has_what', 'id', 'io_loop', 'list_datasets', 'log_event', 'loop', 'map', 'nbytes', 'ncores', 'normalize_collection', 'nthreads', 'persist', 'preloads', 'processing', 'profile', 'publish_dataset', 'rebalance', 'recreate_error_locally', 'recreate_task_locally', 'refcount', 'register_scheduler_plugin', 'register_worker_callbacks', 'register_worker_plugin', 'replicate', 'restart', 'restart_workers', 'retire_workers', 'retry', 'rpc', 'run', 'run_on_scheduler', 'scatter', 'scheduler', 'scheduler_comm', 'scheduler_file', 'scheduler_info', 'security', 'set_metadata', 'shutdown', 'start', 'status', 'story', 'submit', 'subscribe_topic', 'sync', 'unforward_logging', 'unpublish_dataset', 'unregister_worker_plugin', 'unsubscribe_topic', 'upload_file', 'wait_for_workers', 'who_has', 'write_scheduler_file']
2025-05-30 03:30:51,543 - src.infrastructure.distributed_processing - INFO - Dask LocalCluster started and client connected: http://127.0.0.1:36705/status
2025-05-30 03:30:51,543 - src.infrastructure.health_monitoring - INFO - HealthMonitor: DistributedProcessingManager started successfully.
2025-05-30 03:30:51,544 - src.main - INFO - HealthMonitor initialized and Dask started, attached to app_param.state.health_monitor
2025-05-30 03:30:51,546 - src.main - ERROR - CRITICAL: Failed to initialize Kafka producer: name 'get_kafka_producer' is not defined
Traceback (most recent call last):
  File "/app/src/main.py", line 94, in lifespan
    kafka_producer_instance = get_kafka_producer()
NameError: name 'get_kafka_producer' is not defined
2025-05-30 03:30:51,572 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.analysis.events
2025-05-30 03:30:51,574 - src.infrastructure.kafka_client - INFO - Started consumer for topic nis.batch.events
